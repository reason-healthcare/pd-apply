{
	"info": {
		"_postman_id": "783d4570-6094-401c-953f-86e66b7635f8",
		"name": "CPG 2.0 Unit Tests - Activity Definitions",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "25403373"
	},
	"item": [
		{
			"name": "ActivityDefinition - AdministerMedicationParameters",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const expected = {",
							"  \"resourceType\": \"Task\",",
							"  \"id\": \"AdministerMedicationExpected\",",
							"  \"meta\": {",
							"    \"profile\": [",
							"      \"http://example.org/StructureDefinition/FixedCPGTaskAdministerMedication\"",
							"    ]",
							"  },",
							"  \"input\": [",
							"    {",
							"      \"type\": {",
							"        \"coding\": [",
							"          {",
							"            \"code\": \"administer-medication\",",
							"            \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",",
							"            \"display\": \"Administer a medication\"",
							"          }",
							"        ]",
							"      },",
							"      \"valueReference\": {",
							"        \"reference\": \"MedicationRequest/PastMedicationRequest\"",
							"      }",
							"    }",
							"  ],",
							"  \"status\": \"draft\",",
							"  \"intent\": \"proposal\",",
							"  \"instantiatesCanonical\": \"http://example.org/ActivityDefinition/AdministerMedicationActivity|0.1.0\",",
							"  \"code\": {",
							"    \"coding\": [",
							"      {",
							"        \"code\": \"administer-medication\",",
							"        \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",",
							"        \"display\": \"Administer a medication\"",
							"      }",
							"    ]",
							"  },",
							"  \"for\": {",
							"    \"reference\": \"Patient/Patient1\"",
							"  },",
							"  \"encounter\": {",
							"    \"reference\": \"Encounter/Encounter1\"",
							"  },",
							"  \"requester\": {",
							"    \"reference\": \"Practitioner/Practitioner1\"",
							"  }",
							"}",
							"",
							"",
							"",
							"//profiles do not match because of new profiles in repo",
							"",
							"pm.test(\"ActivityDefinition: Administer Medication Activity $apply\", function() {",
							"    pm.response.to.have.status(200)",
							"    _.expectToDeepEqual(pm.response.json(), expected, console)",
							"})"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json+fhir",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"resourceType\": \"Parameters\",\n    \"id\": \"AdministerMedicationParameters\",\n    \"parameter\": [\n        {\n            \"name\": \"subject\",\n            \"valueString\": \"Patient/Patient1\"\n        },\n        {\n            \"name\": \"practitioner\",\n            \"valueString\": \"Practitioner/Practitioner1\"\n        },\n        {\n            \"name\": \"encounter\",\n            \"valueString\": \"Encounter/Encounter1\"\n        },\n        {\n        \"name\": \"activityDefinition\",\n        \"resource\": {\n            \"resourceType\": \"ActivityDefinition\",\n            \"id\": \"AdministerMedicationActivity\",\n            \"meta\": {\n            \"profile\": [\n                \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-administermedicationactivity\"\n            ]\n            },\n            \"kind\": \"Task\",\n            \"profile\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-administermedicationtask\",\n            \"intent\": \"proposal\",\n            \"url\": \"http://example.org/ActivityDefinition/AdministerMedicationActivity\",\n            \"name\": \"AdministerMedicationActivity\",\n            \"title\": \"ActivityDefinition AdministerMedicationActivity\",\n            \"status\": \"draft\",\n            \"experimental\": true,\n            \"publisher\": \"Example\",\n            \"jurisdiction\": [\n            {\n                \"coding\": [\n                {\n                    \"code\": \"001\",\n                    \"system\": \"http://unstats.un.org/unsd/methods/m49/m49.htm\",\n                    \"display\": \"World\"\n                }\n                ]\n            }\n            ],\n            \"version\": \"0.1.0\",\n            \"description\": \"Example Activity Definition for a recommendation to administer a medication\",\n            \"code\": {\n            \"coding\": [\n                {\n                \"code\": \"administer-medication\",\n                \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",\n                \"display\": \"Administer a medication\"\n                }\n            ]\n            },\n            \"doNotPerform\": false,\n            \"dynamicValue\": [\n            {\n                \"path\": \"input[0].type\",\n                \"expression\": {\n                \"language\": \"text/fhirpath\",\n                \"expression\": \"%context.code\"\n                }\n            },\n            {\n                \"path\": \"input[0].valueReference\",\n                \"expression\": {\n                \"language\": \"text/cql-identifier\",\n                \"expression\": \"Medication Proposal Reference\",\n                \"reference\": \"http://example.org/Library/AdministerMedicationLibrary\"\n                }\n            }\n            ]\n        }\n        },\n        {\n            \"name\": \"contentEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{contentEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"content\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{contentEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"terminologyEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{terminologyEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"terminology\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{terminologyEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"data\",\n            \"resource\": {\n                \"resourceType\": \"Bundle\",\n                \"id\": \"PatientTestBundle1\",\n                \"type\": \"collection\",\n                \"entry\": [\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Patient\",\n                            \"id\": \"Patient1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Alice\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Encounter\",\n                            \"id\": \"Encounter1\",\n                            \"status\": \"in-progress\",\n                            \"class\": {\n                                \"code\": \"AMB\",\n                                \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"participant\": [\n                                {\n                                    \"individual\": {\n                                        \"reference\": \"Practitioner/Practitioner1\"\n                                    }\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Practitioner\",\n                            \"id\": \"Practitioner1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Michael\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"MedicationRequest\",\n                            \"id\": \"PastMedicationRequest\",\n                            \"status\": \"active\",\n                            \"intent\": \"order\",\n                            \"authoredOn\": \"2023-01-01\",\n                            \"medicationCodeableConcept\": {\n                                \"text\": \"Some medication\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            }\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"DetectedIssue\",\n                            \"id\": \"DetectedIssue1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"TIME\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\",\n                                        \"display\": \"Time-related Detected Issue\"\n                                    }\n                                ]\n                            },\n                            \"severity\": \"high\",\n                            \"patient\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"identifiedDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Condition\",\n                            \"id\": \"Condition1\",\n                            \"clinicalStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"active\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-clinical\"\n                                    }\n                                ]\n                            },\n                            \"verificationStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provisional\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-ver-status\"\n                                    }\n                                ]\n                            },\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"problem-list-item\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/condition-category\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"422504002\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Ischemic stroke (disorder)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"recordedDate\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Observation\",\n                            \"id\": \"Inference1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"text\": \"Inference\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"effectiveDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Flag\",\n                            \"id\": \"Flag1\",\n                            \"status\": \"active\",\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"admin\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/flag-category\",\n                                            \"display\": \"Administrative\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"text\": \"Flag\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"period\": {\n                                \"start\": \"2023-01-01\",\n                                \"end\": \"2024-01-01\"\n                            }\n                        }\n                    }\n                ]\n            }\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{cpgServer}}/ActivityDefinition/$apply",
					"host": [
						"{{cpgServer}}"
					],
					"path": [
						"ActivityDefinition",
						"$apply"
					]
				}
			},
			"response": []
		},
		{
			"name": "ActivityDefinition - CollectInformationParameters",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const expected = {",
							"  \"resourceType\": \"Task\",",
							"  \"id\": \"CollectInformationExpected\",",
							"  \"meta\": {",
							"    \"profile\": [",
							"      \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-questionnairetask\"",
							"    ]",
							"  },",
							"  \"input\": [",
							"    {",
							"      \"type\": {",
							"        \"coding\": [",
							"          {",
							"            \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",",
							"            \"code\": \"collect-information\",",
							"            \"display\": \"Collect information\"",
							"          }",
							"        ]",
							"      },",
							"      \"valueCanonical\": \"http://hl7.org/fhir/uv/cpg/Questionnaire/activity-example-collectinformation\"",
							"    }",
							"  ],",
							"  \"status\": \"draft\",",
							"  \"intent\": \"proposal\",",
							"  \"instantiatesCanonical\": \"http://example.org/ActivityDefinition/CollectInformationActivity|0.1.0\",",
							"  \"code\": {",
							"    \"coding\": [",
							"      {",
							"        \"code\": \"collect-information\",",
							"        \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",",
							"        \"display\": \"Collect information\"",
							"      }",
							"    ]",
							"  },",
							"  \"for\": {",
							"    \"reference\": \"Patient/Patient1\"",
							"  },",
							"  \"encounter\": {",
							"    \"reference\": \"Encounter/Encounter1\"",
							"  },",
							"  \"requester\": {",
							"    \"reference\": \"Practitioner/Practitioner1\"",
							"  }",
							"}",
							"",
							"",
							"",
							"pm.test(\"ActivityDefinition: Collect Information Activity $apply\", function () {",
							"    pm.response.to.have.status(200)",
							"    _.expectToDeepEqual(pm.response.json(), expected, console)",
							"})"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json+fhir",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"resourceType\": \"Parameters\",\n    \"id\": \"CollectInformationParameters\",\n    \"parameter\": [\n        {\n            \"name\": \"subject\",\n            \"valueString\": \"Patient/Patient1\"\n        },\n        {\n            \"name\": \"practitioner\",\n            \"valueString\": \"Practitioner/Practitioner1\"\n        },\n        {\n            \"name\": \"encounter\",\n            \"valueString\": \"Encounter/Encounter1\"\n        },\n        {\n        \"name\": \"activityDefinition\",\n        \"resource\": {\n            \"resourceType\": \"ActivityDefinition\",\n            \"id\": \"CollectInformationActivity\",\n            \"meta\": {\n            \"profile\": [\n                \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-collectinformationactivity\"\n            ]\n            },\n            \"kind\": \"Task\",\n            \"profile\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-questionnairetask\",\n            \"intent\": \"proposal\",\n            \"extension\": [\n            {\n                \"url\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-collectWith\",\n                \"valueCanonical\": \"http://hl7.org/fhir/uv/cpg/Questionnaire/activity-example-collectinformation\"\n            }\n            ],\n            \"url\": \"http://example.org/ActivityDefinition/CollectInformationActivity\",\n            \"name\": \"CollectInformationActivity\",\n            \"title\": \"ActivityDefinition CollectInformationActivity\",\n            \"status\": \"draft\",\n            \"experimental\": true,\n            \"publisher\": \"Example\",\n            \"jurisdiction\": [\n            {\n                \"coding\": [\n                {\n                    \"code\": \"001\",\n                    \"system\": \"http://unstats.un.org/unsd/methods/m49/m49.htm\",\n                    \"display\": \"World\"\n                }\n                ]\n            }\n            ],\n            \"version\": \"0.1.0\",\n            \"description\": \"Example Activity Definition for a recommendation to collect information\",\n            \"code\": {\n            \"coding\": [\n                {\n                \"code\": \"collect-information\",\n                \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",\n                \"display\": \"Collect information\"\n                }\n            ]\n            },\n            \"doNotPerform\": false,\n            \"dynamicValue\": [\n            {\n                \"path\": \"input[0].type\",\n                \"expression\": {\n                \"language\": \"text/fhirpath\",\n                \"expression\": \"%context.code\"\n                }\n            },\n            {\n                \"path\": \"input[0].valueCanonical\",\n                \"expression\": {\n                \"language\": \"text/fhirpath\",\n                \"expression\": \"%context.extension.where(url='http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-collectWith').value\"\n                }\n            }\n            ]\n        }\n        },\n        {\n            \"name\": \"contentEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{contentEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"content\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{contentEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"terminologyEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{terminologyEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"terminology\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{terminologyEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"data\",\n            \"resource\": {\n                \"resourceType\": \"Bundle\",\n                \"id\": \"PatientTestBundle1\",\n                \"type\": \"collection\",\n                \"entry\": [\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Patient\",\n                            \"id\": \"Patient1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Alice\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Encounter\",\n                            \"id\": \"Encounter1\",\n                            \"status\": \"in-progress\",\n                            \"class\": {\n                                \"code\": \"AMB\",\n                                \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"participant\": [\n                                {\n                                    \"individual\": {\n                                        \"reference\": \"Practitioner/Practitioner1\"\n                                    }\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Practitioner\",\n                            \"id\": \"Practitioner1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Michael\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"MedicationRequest\",\n                            \"id\": \"PastMedicationRequest\",\n                            \"status\": \"active\",\n                            \"intent\": \"order\",\n                            \"authoredOn\": \"2023-01-01\",\n                            \"medicationCodeableConcept\": {\n                                \"text\": \"Some medication\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            }\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"DetectedIssue\",\n                            \"id\": \"DetectedIssue1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"TIME\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\",\n                                        \"display\": \"Time-related Detected Issue\"\n                                    }\n                                ]\n                            },\n                            \"severity\": \"high\",\n                            \"patient\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"identifiedDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Condition\",\n                            \"id\": \"Condition1\",\n                            \"clinicalStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"active\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-clinical\"\n                                    }\n                                ]\n                            },\n                            \"verificationStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provisional\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-ver-status\"\n                                    }\n                                ]\n                            },\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"problem-list-item\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/condition-category\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"422504002\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Ischemic stroke (disorder)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"recordedDate\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Observation\",\n                            \"id\": \"Inference1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"text\": \"Inference\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"effectiveDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Flag\",\n                            \"id\": \"Flag1\",\n                            \"status\": \"active\",\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"admin\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/flag-category\",\n                                            \"display\": \"Administrative\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"text\": \"Flag\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"period\": {\n                                \"start\": \"2023-01-01\",\n                                \"end\": \"2024-01-01\"\n                            }\n                        }\n                    }\n                ]\n            }\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{cpgServer}}/ActivityDefinition/$apply",
					"host": [
						"{{cpgServer}}"
					],
					"path": [
						"ActivityDefinition",
						"$apply"
					]
				}
			},
			"response": []
		},
		{
			"name": "ActivityDefinition - DispenseMedicationParameters",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const expected = {",
							"  \"resourceType\": \"Task\",",
							"  \"id\": \"DispenseMedicationExpected\",",
							"  \"meta\": {",
							"    \"profile\": [",
							"      \"http://example.org/StructureDefinition/FixedCPGTaskDispenseMedication\"",
							"    ]",
							"  },",
							"  \"input\": [",
							"    {",
							"      \"type\": {",
							"        \"coding\": [",
							"          {",
							"            \"code\": \"dispense-medication\",",
							"            \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",",
							"            \"display\": \"Dispense a Medication\"",
							"          }",
							"        ]",
							"      },",
							"      \"valueReference\": {",
							"        \"reference\": \"MedicationRequest/PastMedicationRequest\"",
							"      }",
							"    }",
							"  ],",
							"  \"status\": \"draft\",",
							"  \"intent\": \"proposal\",",
							"  \"instantiatesCanonical\": \"http://example.org/ActivityDefinition/DispenseMedicationActivity|0.1.0\",",
							"  \"code\": {",
							"    \"coding\": [",
							"      {",
							"        \"code\": \"dispense-medication\",",
							"        \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",",
							"        \"display\": \"Dispense a Medication\"",
							"      }",
							"    ]",
							"  },",
							"  \"for\": {",
							"    \"reference\": \"Patient/Patient1\"",
							"  },",
							"  \"encounter\": {",
							"    \"reference\": \"Encounter/Encounter1\"",
							"  },",
							"  \"requester\": {",
							"    \"reference\": \"Practitioner/Practitioner1\"",
							"  }",
							"}",
							"",
							"pm.test(\"ActivityDefinition: Dispense Medication Activity $apply\", function () {",
							"    pm.response.to.have.status(200)",
							"    _.expectToDeepEqual(pm.response.json(), expected, console)",
							"})"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json+fhir",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"resourceType\": \"Parameters\",\n    \"id\": \"DispenseMedicationParameters\",\n    \"parameter\": [\n        {\n            \"name\": \"subject\",\n            \"valueString\": \"Patient/Patient1\"\n        },\n        {\n            \"name\": \"practitioner\",\n            \"valueString\": \"Practitioner/Practitioner1\"\n        },\n        {\n            \"name\": \"encounter\",\n            \"valueString\": \"Encounter/Encounter1\"\n        },\n        {\n        \"name\": \"activityDefinition\",\n        \"resource\": {\n            \"resourceType\": \"ActivityDefinition\",\n            \"id\": \"DispenseMedicationActivity\",\n            \"meta\": {\n            \"profile\": [\n                \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-dispensemedicationactivity\"\n            ]\n            },\n            \"kind\": \"Task\",\n            \"profile\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-dispensemedicationtask\",\n            \"intent\": \"proposal\",\n            \"url\": \"http://example.org/ActivityDefinition/DispenseMedicationActivity\",\n            \"name\": \"DispenseMedicationActivity\",\n            \"title\": \"ActivityDefinition DispenseMedicationActivity\",\n            \"status\": \"draft\",\n            \"experimental\": true,\n            \"publisher\": \"Example\",\n            \"jurisdiction\": [\n            {\n                \"coding\": [\n                {\n                    \"code\": \"001\",\n                    \"system\": \"http://unstats.un.org/unsd/methods/m49/m49.htm\",\n                    \"display\": \"World\"\n                }\n                ]\n            }\n            ],\n            \"version\": \"0.1.0\",\n            \"description\": \"Dispense medication activity\",\n            \"code\": {\n            \"coding\": [\n                {\n                \"code\": \"dispense-medication\",\n                \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",\n                \"display\": \"Dispense a Medication\"\n                }\n            ]\n            },\n            \"doNotPerform\": false,\n            \"dynamicValue\": [\n            {\n                \"path\": \"input[0].type\",\n                \"expression\": {\n                \"language\": \"text/fhirpath\",\n                \"expression\": \"%context.code\"\n                }\n            },\n            {\n                \"path\": \"input[0].valueReference\",\n                \"expression\": {\n                \"language\": \"text/cql-identifier\",\n                \"expression\": \"Medication Proposal Reference\",\n                \"reference\": \"http://example.org/Library/DispenseMedicationLibrary\"\n                }\n            }\n            ]\n        }\n        },\n        {\n            \"name\": \"contentEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{contentEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"content\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{contentEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"terminologyEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{terminologyEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"terminology\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{terminologyEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"data\",\n            \"resource\": {\n                \"resourceType\": \"Bundle\",\n                \"id\": \"PatientTestBundle1\",\n                \"type\": \"collection\",\n                \"entry\": [\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Patient\",\n                            \"id\": \"Patient1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Alice\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Encounter\",\n                            \"id\": \"Encounter1\",\n                            \"status\": \"in-progress\",\n                            \"class\": {\n                                \"code\": \"AMB\",\n                                \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"participant\": [\n                                {\n                                    \"individual\": {\n                                        \"reference\": \"Practitioner/Practitioner1\"\n                                    }\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Practitioner\",\n                            \"id\": \"Practitioner1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Michael\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"MedicationRequest\",\n                            \"id\": \"PastMedicationRequest\",\n                            \"status\": \"active\",\n                            \"intent\": \"order\",\n                            \"authoredOn\": \"2023-01-01\",\n                            \"medicationCodeableConcept\": {\n                                \"text\": \"Some medication\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            }\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"DetectedIssue\",\n                            \"id\": \"DetectedIssue1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"TIME\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\",\n                                        \"display\": \"Time-related Detected Issue\"\n                                    }\n                                ]\n                            },\n                            \"severity\": \"high\",\n                            \"patient\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"identifiedDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Condition\",\n                            \"id\": \"Condition1\",\n                            \"clinicalStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"active\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-clinical\"\n                                    }\n                                ]\n                            },\n                            \"verificationStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provisional\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-ver-status\"\n                                    }\n                                ]\n                            },\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"problem-list-item\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/condition-category\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"422504002\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Ischemic stroke (disorder)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"recordedDate\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Observation\",\n                            \"id\": \"Inference1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"text\": \"Inference\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"effectiveDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Flag\",\n                            \"id\": \"Flag1\",\n                            \"status\": \"active\",\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"admin\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/flag-category\",\n                                            \"display\": \"Administrative\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"text\": \"Flag\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"period\": {\n                                \"start\": \"2023-01-01\",\n                                \"end\": \"2024-01-01\"\n                            }\n                        }\n                    }\n                ]\n            }\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{cpgServer}}/ActivityDefinition/$apply",
					"host": [
						"{{cpgServer}}"
					],
					"path": [
						"ActivityDefinition",
						"$apply"
					]
				}
			},
			"response": []
		},
		{
			"name": "ActivityDefinition - DocumentMedicationParameters",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const expected = {",
							"  \"resourceType\": \"Task\",",
							"  \"id\": \"DocumentMedicationExpected\",",
							"  \"meta\": {",
							"    \"profile\": [",
							"      \"http://example.org/StructureDefinition/FixedCPGTaskDocumentMedication\"",
							"    ]",
							"  },",
							"  \"input\": [",
							"    {",
							"      \"type\": {",
							"        \"coding\": [",
							"          {",
							"            \"code\": \"document-medication\",",
							"            \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",",
							"            \"display\": \"Document a medication\"",
							"          }",
							"        ]",
							"      },",
							"      \"valueReference\": {",
							"        \"reference\": \"MedicationRequest/PastMedicationRequest\"",
							"      }",
							"    }",
							"  ],",
							"  \"status\": \"draft\",",
							"  \"intent\": \"proposal\",",
							"  \"instantiatesCanonical\": \"http://example.org/ActivityDefinition/DocumentMedicationActivity|0.1.0\",",
							"  \"code\": {",
							"    \"coding\": [",
							"      {",
							"        \"code\": \"document-medication\",",
							"        \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",",
							"        \"display\": \"Document a medication\"",
							"      }",
							"    ]",
							"  },",
							"  \"for\": {",
							"    \"reference\": \"Patient/Patient1\"",
							"  },",
							"  \"encounter\": {",
							"    \"reference\": \"Encounter/Encounter1\"",
							"  },",
							"  \"requester\": {",
							"    \"reference\": \"Practitioner/Practitioner1\"",
							"  }",
							"}",
							"",
							"",
							"",
							"//profiles do not match because of profile edits",
							"",
							"pm.test(\"ActivityDefinition: Document Medication Activity $apply\", function () {",
							"    pm.response.to.have.status(200)",
							"    _.expectToDeepEqual(pm.response.json(), expected, console)",
							"})"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json+fhir",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"resourceType\": \"Parameters\",\n    \"id\": \"DocumentMedicationParameters\",\n    \"parameter\": [\n        {\n            \"name\": \"subject\",\n            \"valueString\": \"Patient/Patient1\"\n        },\n        {\n            \"name\": \"practitioner\",\n            \"valueString\": \"Practitioner/Practitioner1\"\n        },\n        {\n            \"name\": \"encounter\",\n            \"valueString\": \"Encounter/Encounter1\"\n        },\n        {\n        \"name\": \"activityDefinition\",\n        \"resource\": {\n            \"resourceType\": \"ActivityDefinition\",\n            \"id\": \"DocumentMedicationActivity\",\n            \"meta\": {\n            \"profile\": [\n                \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-documentmedicationactivity\"\n            ]\n            },\n            \"kind\": \"Task\",\n            \"profile\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-documentmedicationtask\",\n            \"intent\": \"proposal\",\n            \"url\": \"http://example.org/ActivityDefinition/DocumentMedicationActivity\",\n            \"name\": \"DocumentMedicationActivity\",\n            \"title\": \"ActivityDefinition DocumentMedicationActivity\",\n            \"status\": \"draft\",\n            \"experimental\": true,\n            \"publisher\": \"Example\",\n            \"jurisdiction\": [\n            {\n                \"coding\": [\n                {\n                    \"code\": \"001\",\n                    \"system\": \"http://unstats.un.org/unsd/methods/m49/m49.htm\",\n                    \"display\": \"World\"\n                }\n                ]\n            }\n            ],\n            \"version\": \"0.1.0\",\n            \"description\": \"Example Activity Definition for a recommendation to document a medication\",\n            \"code\": {\n            \"coding\": [\n                {\n                \"code\": \"document-medication\",\n                \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",\n                \"display\": \"Document a medication\"\n                }\n            ]\n            },\n            \"doNotPerform\": false,\n            \"dynamicValue\": [\n            {\n                \"path\": \"input[0].type\",\n                \"expression\": {\n                \"language\": \"text/fhirpath\",\n                \"expression\": \"%context.code\"\n                }\n            },\n            {\n                \"path\": \"input[0].valueReference\",\n                \"expression\": {\n                \"language\": \"text/cql-identifier\",\n                \"expression\": \"Medication Proposal Reference\",\n                \"reference\": \"http://example.org/Library/DocumentMedicationLibrary\"\n                }\n            }\n            ]\n        }\n        },\n        {\n            \"name\": \"contentEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{contentEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"content\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{contentEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"terminologyEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{terminologyEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"terminology\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{terminologyEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"data\",\n            \"resource\": {\n                \"resourceType\": \"Bundle\",\n                \"id\": \"PatientTestBundle1\",\n                \"type\": \"collection\",\n                \"entry\": [\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Patient\",\n                            \"id\": \"Patient1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Alice\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Encounter\",\n                            \"id\": \"Encounter1\",\n                            \"status\": \"in-progress\",\n                            \"class\": {\n                                \"code\": \"AMB\",\n                                \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"participant\": [\n                                {\n                                    \"individual\": {\n                                        \"reference\": \"Practitioner/Practitioner1\"\n                                    }\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Practitioner\",\n                            \"id\": \"Practitioner1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Michael\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"MedicationRequest\",\n                            \"id\": \"PastMedicationRequest\",\n                            \"status\": \"active\",\n                            \"intent\": \"order\",\n                            \"authoredOn\": \"2023-01-01\",\n                            \"medicationCodeableConcept\": {\n                                \"text\": \"Some medication\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            }\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"DetectedIssue\",\n                            \"id\": \"DetectedIssue1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"TIME\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\",\n                                        \"display\": \"Time-related Detected Issue\"\n                                    }\n                                ]\n                            },\n                            \"severity\": \"high\",\n                            \"patient\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"identifiedDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Condition\",\n                            \"id\": \"Condition1\",\n                            \"clinicalStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"active\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-clinical\"\n                                    }\n                                ]\n                            },\n                            \"verificationStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provisional\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-ver-status\"\n                                    }\n                                ]\n                            },\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"problem-list-item\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/condition-category\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"422504002\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Ischemic stroke (disorder)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"recordedDate\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Observation\",\n                            \"id\": \"Inference1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"text\": \"Inference\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"effectiveDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Flag\",\n                            \"id\": \"Flag1\",\n                            \"status\": \"active\",\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"admin\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/flag-category\",\n                                            \"display\": \"Administrative\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"text\": \"Flag\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"period\": {\n                                \"start\": \"2023-01-01\",\n                                \"end\": \"2024-01-01\"\n                            }\n                        }\n                    }\n                ]\n            }\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{cpgServer}}/ActivityDefinition/$apply",
					"host": [
						"{{cpgServer}}"
					],
					"path": [
						"ActivityDefinition",
						"$apply"
					]
				}
			},
			"response": []
		},
		{
			"name": "ActivityDefinition - DontCollectInformationParameters",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const expected = {",
							"  \"resourceType\": \"Task\",",
							"  \"id\": \"DontCollectInformationExpected\",",
							"  \"meta\": {",
							"    \"profile\": [",
							"      \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-questionnairetask\"",
							"    ]",
							"  },",
							"  \"input\": [",
							"    {",
							"      \"type\": {",
							"        \"coding\": [",
							"          {",
							"            \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",",
							"            \"code\": \"collect-information\",",
							"            \"display\": \"Collect information\"",
							"          }",
							"        ]",
							"      },",
							"      \"valueCanonical\": \"http://hl7.org/fhir/uv/cpg/Questionnaire/activity-example-collectinformation\"",
							"    }",
							"  ],",
							"  \"modifierExtension\": [",
							"    {",
							"      \"url\": \"http://hl7.org/fhir/StructureDefinition/request-doNotPerform\",",
							"      \"valueBoolean\": true",
							"    }",
							"  ],",
							"  \"status\": \"draft\",",
							"  \"intent\": \"proposal\",",
							"  \"instantiatesCanonical\": \"http://example.org/ActivityDefinition/DontCollectInformationActivity|0.1.0\",",
							"  \"code\": {",
							"    \"coding\": [",
							"      {",
							"        \"code\": \"collect-information\",",
							"        \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",",
							"        \"display\": \"Collect information\"",
							"      }",
							"    ]",
							"  },",
							"  \"for\": {",
							"    \"reference\": \"Patient/Patient1\"",
							"  },",
							"  \"encounter\": {",
							"    \"reference\": \"Encounter/Encounter1\"",
							"  },",
							"  \"requester\": {",
							"    \"reference\": \"Practitioner/Practitioner1\"",
							"  }",
							"}",
							"",
							"",
							"",
							"pm.test(\"ActivityDefinition: Don't Collect Information Activity $apply\", function () {",
							"    pm.response.to.have.status(200)",
							"    _.expectToDeepEqual(pm.response.json(), expected, console)",
							"})"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json+fhir",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"resourceType\": \"Parameters\",\n    \"id\": \"DontCollectInformationParameters\",\n    \"parameter\": [\n        {\n            \"name\": \"subject\",\n            \"valueString\": \"Patient/Patient1\"\n        },\n        {\n            \"name\": \"practitioner\",\n            \"valueString\": \"Practitioner/Practitioner1\"\n        },\n        {\n            \"name\": \"encounter\",\n            \"valueString\": \"Encounter/Encounter1\"\n        },\n        {\n        \"name\": \"activityDefinition\",\n        \"resource\": {\n            \"resourceType\": \"ActivityDefinition\",\n            \"id\": \"DontCollectInformationActivity\",\n            \"meta\": {\n            \"profile\": [\n                \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-collectinformationactivity\"\n            ]\n            },\n            \"kind\": \"Task\",\n            \"profile\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-questionnairetask\",\n            \"intent\": \"proposal\",\n            \"extension\": [\n            {\n                \"url\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-collectWith\",\n                \"valueCanonical\": \"http://hl7.org/fhir/uv/cpg/Questionnaire/activity-example-collectinformation\"\n            }\n            ],\n            \"url\": \"http://example.org/ActivityDefinition/DontCollectInformationActivity\",\n            \"name\": \"DontCollectInformationActivity\",\n            \"title\": \"ActivityDefinition DontCollectInformationActivity\",\n            \"status\": \"draft\",\n            \"experimental\": true,\n            \"publisher\": \"Example\",\n            \"jurisdiction\": [\n            {\n                \"coding\": [\n                {\n                    \"code\": \"001\",\n                    \"system\": \"http://unstats.un.org/unsd/methods/m49/m49.htm\",\n                    \"display\": \"World\"\n                }\n                ]\n            }\n            ],\n            \"version\": \"0.1.0\",\n            \"description\": \"Example Activity Definition for a recommendation not to collect information\",\n            \"code\": {\n            \"coding\": [\n                {\n                \"code\": \"collect-information\",\n                \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",\n                \"display\": \"Collect information\"\n                }\n            ]\n            },\n            \"doNotPerform\": true,\n            \"dynamicValue\": [\n            {\n                \"path\": \"input[0].type\",\n                \"expression\": {\n                \"language\": \"text/fhirpath\",\n                \"expression\": \"%context.code\"\n                }\n            },\n            {\n                \"path\": \"input[0].valueCanonical\",\n                \"expression\": {\n                \"language\": \"text/fhirpath\",\n                \"expression\": \"%context.extension.where(url='http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-collectWith').value\"\n                }\n            }\n            ]\n        }\n        },\n        {\n            \"name\": \"contentEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{contentEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"content\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{contentEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"terminologyEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{terminologyEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"terminology\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{terminologyEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"data\",\n            \"resource\": {\n                \"resourceType\": \"Bundle\",\n                \"id\": \"PatientTestBundle1\",\n                \"type\": \"collection\",\n                \"entry\": [\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Patient\",\n                            \"id\": \"Patient1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Alice\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Encounter\",\n                            \"id\": \"Encounter1\",\n                            \"status\": \"in-progress\",\n                            \"class\": {\n                                \"code\": \"AMB\",\n                                \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"participant\": [\n                                {\n                                    \"individual\": {\n                                        \"reference\": \"Practitioner/Practitioner1\"\n                                    }\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Practitioner\",\n                            \"id\": \"Practitioner1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Michael\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"MedicationRequest\",\n                            \"id\": \"PastMedicationRequest\",\n                            \"status\": \"active\",\n                            \"intent\": \"order\",\n                            \"authoredOn\": \"2023-01-01\",\n                            \"medicationCodeableConcept\": {\n                                \"text\": \"Some medication\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            }\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"DetectedIssue\",\n                            \"id\": \"DetectedIssue1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"TIME\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\",\n                                        \"display\": \"Time-related Detected Issue\"\n                                    }\n                                ]\n                            },\n                            \"severity\": \"high\",\n                            \"patient\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"identifiedDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Condition\",\n                            \"id\": \"Condition1\",\n                            \"clinicalStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"active\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-clinical\"\n                                    }\n                                ]\n                            },\n                            \"verificationStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provisional\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-ver-status\"\n                                    }\n                                ]\n                            },\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"problem-list-item\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/condition-category\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"422504002\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Ischemic stroke (disorder)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"recordedDate\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Observation\",\n                            \"id\": \"Inference1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"text\": \"Inference\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"effectiveDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Flag\",\n                            \"id\": \"Flag1\",\n                            \"status\": \"active\",\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"admin\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/flag-category\",\n                                            \"display\": \"Administrative\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"text\": \"Flag\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"period\": {\n                                \"start\": \"2023-01-01\",\n                                \"end\": \"2024-01-01\"\n                            }\n                        }\n                    }\n                ]\n            }\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{cpgServer}}/ActivityDefinition/$apply",
					"host": [
						"{{cpgServer}}"
					],
					"path": [
						"ActivityDefinition",
						"$apply"
					]
				}
			},
			"response": []
		},
		{
			"name": "ActivityDefinition - DontSendMessageParameters",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const expected = {",
							"  \"resourceType\": \"CommunicationRequest\",",
							"  \"id\": \"DontSendMessageExpected\",",
							"  \"meta\": {",
							"    \"profile\": [",
							"      \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-communicationrequest\"",
							"    ]",
							"  },",
							"  \"status\": \"draft\",",
							"  \"doNotPerform\": true,",
							"  \"subject\": {",
							"    \"reference\": \"Patient/Patient1\"",
							"  },",
							"  \"encounter\": {",
							"    \"reference\": \"Encounter/Encounter1\"",
							"  },",
							"  \"requester\": {",
							"    \"reference\": \"Practitioner/Practitioner1\"",
							"  },",
							"  \"payload\": [",
							"    {",
							"      \"contentString\": \"Hello! Example Activity Definition for a recommendation not to send a message\"",
							"    }",
							"  ]",
							"}",
							"",
							"",
							"",
							"pm.test(\"ActivityDefinition: Don't Send Message Activity $apply\", function () {",
							"    pm.response.to.have.status(200)",
							"    _.expectToDeepEqual(pm.response.json(), expected, console)",
							"})"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json+fhir",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"resourceType\": \"Parameters\",\n    \"id\": \"DontSendMessageParameters\",\n    \"parameter\": [\n        {\n            \"name\": \"subject\",\n            \"valueString\": \"Patient/Patient1\"\n        },\n        {\n            \"name\": \"practitioner\",\n            \"valueString\": \"Practitioner/Practitioner1\"\n        },\n        {\n            \"name\": \"encounter\",\n            \"valueString\": \"Encounter/Encounter1\"\n        },\n        {\n        \"name\": \"activityDefinition\",\n        \"resource\": {\n            \"resourceType\": \"ActivityDefinition\",\n            \"id\": \"DontSendMessageActivity\",\n            \"meta\": {\n            \"profile\": [\n                \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-communicationactivity\"\n            ]\n            },\n            \"kind\": \"CommunicationRequest\",\n            \"profile\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-communicationrequest\",\n            \"intent\": \"proposal\",\n            \"url\": \"http://example.org/ActivityDefinition/DontSendMessageActivity\",\n            \"name\": \"DontSendMessageActivity\",\n            \"title\": \"ActivityDefinition DontSendMessageActivity\",\n            \"status\": \"draft\",\n            \"experimental\": true,\n            \"publisher\": \"Example\",\n            \"jurisdiction\": [\n            {\n                \"coding\": [\n                {\n                    \"code\": \"001\",\n                    \"system\": \"http://unstats.un.org/unsd/methods/m49/m49.htm\",\n                    \"display\": \"World\"\n                }\n                ]\n            }\n            ],\n            \"version\": \"0.1.0\",\n            \"description\": \"Example Activity Definition for a recommendation not to send a message\",\n            \"code\": {\n            \"coding\": [\n                {\n                \"code\": \"send-message\",\n                \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",\n                \"display\": \"Send a message\"\n                }\n            ]\n            },\n            \"doNotPerform\": true,\n            \"dynamicValue\": [\n            {\n                \"path\": \"payload[0].contentString\",\n                \"expression\": {\n                \"language\": \"text/fhirpath\",\n                \"expression\": \"'Hello! ' + %context.description\"\n                }\n            }\n            ]\n        }\n        },\n        {\n            \"name\": \"contentEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{contentEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"content\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{contentEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"terminologyEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{terminologyEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"terminology\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{terminologyEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"data\",\n            \"resource\": {\n                \"resourceType\": \"Bundle\",\n                \"id\": \"PatientTestBundle1\",\n                \"type\": \"collection\",\n                \"entry\": [\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Patient\",\n                            \"id\": \"Patient1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Alice\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Encounter\",\n                            \"id\": \"Encounter1\",\n                            \"status\": \"in-progress\",\n                            \"class\": {\n                                \"code\": \"AMB\",\n                                \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"participant\": [\n                                {\n                                    \"individual\": {\n                                        \"reference\": \"Practitioner/Practitioner1\"\n                                    }\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Practitioner\",\n                            \"id\": \"Practitioner1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Michael\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"MedicationRequest\",\n                            \"id\": \"PastMedicationRequest\",\n                            \"status\": \"active\",\n                            \"intent\": \"order\",\n                            \"authoredOn\": \"2023-01-01\",\n                            \"medicationCodeableConcept\": {\n                                \"text\": \"Some medication\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            }\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"DetectedIssue\",\n                            \"id\": \"DetectedIssue1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"TIME\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\",\n                                        \"display\": \"Time-related Detected Issue\"\n                                    }\n                                ]\n                            },\n                            \"severity\": \"high\",\n                            \"patient\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"identifiedDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Condition\",\n                            \"id\": \"Condition1\",\n                            \"clinicalStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"active\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-clinical\"\n                                    }\n                                ]\n                            },\n                            \"verificationStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provisional\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-ver-status\"\n                                    }\n                                ]\n                            },\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"problem-list-item\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/condition-category\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"422504002\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Ischemic stroke (disorder)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"recordedDate\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Observation\",\n                            \"id\": \"Inference1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"text\": \"Inference\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"effectiveDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Flag\",\n                            \"id\": \"Flag1\",\n                            \"status\": \"active\",\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"admin\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/flag-category\",\n                                            \"display\": \"Administrative\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"text\": \"Flag\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"period\": {\n                                \"start\": \"2023-01-01\",\n                                \"end\": \"2024-01-01\"\n                            }\n                        }\n                    }\n                ]\n            }\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{cpgServer}}/ActivityDefinition/$apply",
					"host": [
						"{{cpgServer}}"
					],
					"path": [
						"ActivityDefinition",
						"$apply"
					]
				}
			},
			"response": []
		},
		{
			"name": "ActivityDefinition - EnrollPatientParameters",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const expected = {",
							"  \"resourceType\": \"Task\",",
							"  \"id\": \"EnrollPatientExpected\",",
							"  \"meta\": {",
							"    \"profile\": [",
							"      \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-enrollmenttask\"",
							"    ]",
							"  },",
							"  \"input\": [",
							"    {",
							"      \"type\": {",
							"        \"coding\": [",
							"          {",
							"            \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",",
							"            \"code\": \"enrollment\",",
							"            \"display\": \"Enroll in a pathway or strategy\"",
							"          }",
							"        ]",
							"      },",
							"      \"valueCanonical\": \"http://hl7.org/fhir/uv/cpg/PlanDefinition/activity-example-pathway\"",
							"    }",
							"  ],",
							"  \"status\": \"draft\",",
							"  \"intent\": \"proposal\",",
							"  \"instantiatesCanonical\": \"http://example.org/ActivityDefinition/EnrollPatientActivity|0.1.0\",",
							"  \"code\": {",
							"    \"coding\": [",
							"      {",
							"        \"code\": \"enrollment\",",
							"        \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",",
							"        \"display\": \"Enroll in a pathway or strategy\"",
							"      }",
							"    ]",
							"  },",
							"  \"for\": {",
							"    \"reference\": \"Patient/Patient1\"",
							"  },",
							"  \"encounter\": {",
							"    \"reference\": \"Encounter/Encounter1\"",
							"  },",
							"  \"requester\": {",
							"    \"reference\": \"Practitioner/Practitioner1\"",
							"  }",
							"}",
							"",
							"",
							"",
							"pm.test(\"ActivityDefinition: Enroll Patient Activity $apply\", function () {",
							"    pm.response.to.have.status(200)",
							"    _.expectToDeepEqual(pm.response.json(), expected, console)",
							"})"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json+fhir",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"resourceType\": \"Parameters\",\n    \"id\": \"EnrollPatientParameters\",\n    \"parameter\": [\n        {\n            \"name\": \"subject\",\n            \"valueString\": \"Patient/Patient1\"\n        },\n        {\n            \"name\": \"practitioner\",\n            \"valueString\": \"Practitioner/Practitioner1\"\n        },\n        {\n            \"name\": \"encounter\",\n            \"valueString\": \"Encounter/Encounter1\"\n        },\n        {\n        \"name\": \"activityDefinition\",\n        \"resource\": {\n            \"resourceType\": \"ActivityDefinition\",\n            \"id\": \"EnrollPatientActivity\",\n            \"meta\": {\n            \"profile\": [\n                \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-enrollmentactivity\"\n            ]\n            },\n            \"kind\": \"Task\",\n            \"profile\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-enrollmenttask\",\n            \"intent\": \"proposal\",\n            \"extension\": [\n            {\n                \"url\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-enrollIn\",\n                \"valueCanonical\": \"http://hl7.org/fhir/uv/cpg/PlanDefinition/activity-example-pathway\"\n            }\n            ],\n            \"url\": \"http://example.org/ActivityDefinition/EnrollPatientActivity\",\n            \"name\": \"EnrollPatientActivity\",\n            \"title\": \"ActivityDefinition EnrollPatientActivity\",\n            \"status\": \"draft\",\n            \"experimental\": true,\n            \"publisher\": \"Example\",\n            \"jurisdiction\": [\n            {\n                \"coding\": [\n                {\n                    \"code\": \"001\",\n                    \"system\": \"http://unstats.un.org/unsd/methods/m49/m49.htm\",\n                    \"display\": \"World\"\n                }\n                ]\n            }\n            ],\n            \"version\": \"0.1.0\",\n            \"description\": \"Example Activity Definition for a recommendation to enroll a patient in a pathway\",\n            \"code\": {\n            \"coding\": [\n                {\n                \"code\": \"enrollment\",\n                \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",\n                \"display\": \"Enroll in a pathway or strategy\"\n                }\n            ]\n            },\n            \"doNotPerform\": false,\n            \"dynamicValue\": [\n            {\n                \"path\": \"input[0].type\",\n                \"expression\": {\n                \"language\": \"text/fhirpath\",\n                \"expression\": \"%context.code\"\n                }\n            },\n            {\n                \"path\": \"input[0].valueCanonical\",\n                \"expression\": {\n                \"language\": \"text/fhirpath\",\n                \"expression\": \"%context.extension.where(url='http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-enrollIn').value\"\n                }\n            }\n            ]\n        }\n        },\n        {\n            \"name\": \"contentEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{contentEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"content\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{contentEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"terminologyEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{terminologyEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"terminology\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{terminologyEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"data\",\n            \"resource\": {\n                \"resourceType\": \"Bundle\",\n                \"id\": \"PatientTestBundle1\",\n                \"type\": \"collection\",\n                \"entry\": [\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Patient\",\n                            \"id\": \"Patient1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Alice\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Encounter\",\n                            \"id\": \"Encounter1\",\n                            \"status\": \"in-progress\",\n                            \"class\": {\n                                \"code\": \"AMB\",\n                                \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"participant\": [\n                                {\n                                    \"individual\": {\n                                        \"reference\": \"Practitioner/Practitioner1\"\n                                    }\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Practitioner\",\n                            \"id\": \"Practitioner1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Michael\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"MedicationRequest\",\n                            \"id\": \"PastMedicationRequest\",\n                            \"status\": \"active\",\n                            \"intent\": \"order\",\n                            \"authoredOn\": \"2023-01-01\",\n                            \"medicationCodeableConcept\": {\n                                \"text\": \"Some medication\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            }\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"DetectedIssue\",\n                            \"id\": \"DetectedIssue1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"TIME\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\",\n                                        \"display\": \"Time-related Detected Issue\"\n                                    }\n                                ]\n                            },\n                            \"severity\": \"high\",\n                            \"patient\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"identifiedDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Condition\",\n                            \"id\": \"Condition1\",\n                            \"clinicalStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"active\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-clinical\"\n                                    }\n                                ]\n                            },\n                            \"verificationStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provisional\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-ver-status\"\n                                    }\n                                ]\n                            },\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"problem-list-item\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/condition-category\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"422504002\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Ischemic stroke (disorder)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"recordedDate\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Observation\",\n                            \"id\": \"Inference1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"text\": \"Inference\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"effectiveDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Flag\",\n                            \"id\": \"Flag1\",\n                            \"status\": \"active\",\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"admin\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/flag-category\",\n                                            \"display\": \"Administrative\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"text\": \"Flag\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"period\": {\n                                \"start\": \"2023-01-01\",\n                                \"end\": \"2024-01-01\"\n                            }\n                        }\n                    }\n                ]\n            }\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{cpgServer}}/ActivityDefinition/$apply",
					"host": [
						"{{cpgServer}}"
					],
					"path": [
						"ActivityDefinition",
						"$apply"
					]
				}
			},
			"response": []
		},
		{
			"name": "ActivityDefinition - GenerateReportParameters",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const expected = {",
							"  \"resourceType\": \"Task\",",
							"  \"id\": \"GenerateReportExpected\",",
							"  \"meta\": {",
							"    \"profile\": [",
							"      \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-generatereporttask\"",
							"    ]",
							"  },",
							"  \"input\": [",
							"    {",
							"      \"type\": {",
							"        \"coding\": [",
							"          {",
							"            \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",",
							"            \"code\": \"generate-report\",",
							"            \"display\": \"Generate a metric or case report\"",
							"          }",
							"        ]",
							"      },",
							"      \"valueCanonical\": \"http://hl7.org/fhir/uv/cpg/Measure/activity-example-generatereport\"",
							"    }",
							"  ],",
							"  \"status\": \"draft\",",
							"  \"intent\": \"proposal\",",
							"  \"instantiatesCanonical\": \"http://example.org/ActivityDefinition/GenerateReportActivity|0.1.0\",",
							"  \"code\": {",
							"    \"coding\": [",
							"      {",
							"        \"code\": \"generate-report\",",
							"        \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",",
							"        \"display\": \"Generate a metric or case report\"",
							"      }",
							"    ]",
							"  },",
							"  \"for\": {",
							"    \"reference\": \"Patient/Patient1\"",
							"  },",
							"  \"encounter\": {",
							"    \"reference\": \"Encounter/Encounter1\"",
							"  },",
							"  \"requester\": {",
							"    \"reference\": \"Practitioner/Practitioner1\"",
							"  }",
							"}",
							"",
							"",
							"",
							"pm.test(\"ActivityDefinition: Generate Report Activity $apply\", function () {",
							"    pm.response.to.have.status(200)",
							"    _.expectToDeepEqual(pm.response.json(), expected, console)",
							"})"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json+fhir",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"resourceType\": \"Parameters\",\n    \"id\": \"GenerateReportParameters\",\n    \"parameter\": [\n        {\n            \"name\": \"subject\",\n            \"valueString\": \"Patient/Patient1\"\n        },\n        {\n            \"name\": \"practitioner\",\n            \"valueString\": \"Practitioner/Practitioner1\"\n        },\n        {\n            \"name\": \"encounter\",\n            \"valueString\": \"Encounter/Encounter1\"\n        },\n        {\n        \"name\": \"activityDefinition\",\n        \"resource\": {\n            \"resourceType\": \"ActivityDefinition\",\n            \"id\": \"GenerateReportActivity\",\n            \"meta\": {\n            \"profile\": [\n                \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-generatereportactivity\"\n            ]\n            },\n            \"kind\": \"Task\",\n            \"profile\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-generatereporttask\",\n            \"intent\": \"proposal\",\n            \"extension\": [\n            {\n                \"url\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-reportWith\",\n                \"valueCanonical\": \"http://hl7.org/fhir/uv/cpg/Measure/activity-example-generatereport\"\n            }\n            ],\n            \"url\": \"http://example.org/ActivityDefinition/GenerateReportActivity\",\n            \"name\": \"GenerateReportActivity\",\n            \"title\": \"ActivityDefinition GenerateReportActivity\",\n            \"status\": \"draft\",\n            \"experimental\": true,\n            \"publisher\": \"Example\",\n            \"jurisdiction\": [\n            {\n                \"coding\": [\n                {\n                    \"code\": \"001\",\n                    \"system\": \"http://unstats.un.org/unsd/methods/m49/m49.htm\",\n                    \"display\": \"World\"\n                }\n                ]\n            }\n            ],\n            \"version\": \"0.1.0\",\n            \"description\": \"Example Activity Definition for a recommendation to generate a report\",\n            \"code\": {\n            \"coding\": [\n                {\n                \"code\": \"generate-report\",\n                \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",\n                \"display\": \"Generate a metric or case report\"\n                }\n            ]\n            },\n            \"doNotPerform\": false,\n            \"dynamicValue\": [\n            {\n                \"path\": \"input[0].type\",\n                \"expression\": {\n                \"language\": \"text/fhirpath\",\n                \"expression\": \"%context.code\"\n                }\n            },\n            {\n                \"path\": \"input[0].valueCanonical\",\n                \"expression\": {\n                \"language\": \"text/fhirpath\",\n                \"expression\": \"%context.extension.where(url='http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-reportWith').value\"\n                }\n            }\n            ]\n        }\n        },\n        {\n            \"name\": \"contentEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{contentEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"content\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{contentEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"terminologyEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{terminologyEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"terminology\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{terminologyEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"data\",\n            \"resource\": {\n                \"resourceType\": \"Bundle\",\n                \"id\": \"PatientTestBundle1\",\n                \"type\": \"collection\",\n                \"entry\": [\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Patient\",\n                            \"id\": \"Patient1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Alice\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Encounter\",\n                            \"id\": \"Encounter1\",\n                            \"status\": \"in-progress\",\n                            \"class\": {\n                                \"code\": \"AMB\",\n                                \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"participant\": [\n                                {\n                                    \"individual\": {\n                                        \"reference\": \"Practitioner/Practitioner1\"\n                                    }\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Practitioner\",\n                            \"id\": \"Practitioner1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Michael\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"MedicationRequest\",\n                            \"id\": \"PastMedicationRequest\",\n                            \"status\": \"active\",\n                            \"intent\": \"order\",\n                            \"authoredOn\": \"2023-01-01\",\n                            \"medicationCodeableConcept\": {\n                                \"text\": \"Some medication\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            }\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"DetectedIssue\",\n                            \"id\": \"DetectedIssue1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"TIME\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\",\n                                        \"display\": \"Time-related Detected Issue\"\n                                    }\n                                ]\n                            },\n                            \"severity\": \"high\",\n                            \"patient\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"identifiedDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Condition\",\n                            \"id\": \"Condition1\",\n                            \"clinicalStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"active\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-clinical\"\n                                    }\n                                ]\n                            },\n                            \"verificationStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provisional\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-ver-status\"\n                                    }\n                                ]\n                            },\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"problem-list-item\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/condition-category\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"422504002\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Ischemic stroke (disorder)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"recordedDate\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Observation\",\n                            \"id\": \"Inference1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"text\": \"Inference\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"effectiveDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Flag\",\n                            \"id\": \"Flag1\",\n                            \"status\": \"active\",\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"admin\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/flag-category\",\n                                            \"display\": \"Administrative\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"text\": \"Flag\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"period\": {\n                                \"start\": \"2023-01-01\",\n                                \"end\": \"2024-01-01\"\n                            }\n                        }\n                    }\n                ]\n            }\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{cpgServer}}/ActivityDefinition/$apply",
					"host": [
						"{{cpgServer}}"
					],
					"path": [
						"ActivityDefinition",
						"$apply"
					]
				}
			},
			"response": []
		},
		{
			"name": "ActivityDefinition - OrderMedicationParameters",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const expected = {",
							"  \"resourceType\": \"ServiceRequest\",",
							"  \"id\": \"OrderServiceExpected\",",
							"  \"meta\": {",
							"    \"profile\": [",
							"      \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-servicerequest\"",
							"    ]",
							"  },",
							"  \"status\": \"draft\",",
							"  \"doNotPerform\": false,",
							"  \"intent\": \"proposal\",",
							"  \"instantiatesCanonical\": [",
							"    \"http://example.org/ActivityDefinition/OrderServiceActivity|0.1.0\"",
							"  ],",
							"  \"code\": {",
							"    \"coding\": [",
							"      {",
							"        \"code\": \"order-service\",",
							"        \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",",
							"        \"display\": \"Order a service\"",
							"      }",
							"    ]",
							"  },",
							"  \"subject\": {",
							"    \"reference\": \"Patient/Patient1\"",
							"  },",
							"  \"encounter\": {",
							"    \"reference\": \"Encounter/Encounter1\"",
							"  },",
							"  \"requester\": {",
							"    \"reference\": \"Practitioner/Practitioner1\"",
							"  }",
							"}",
							"",
							"",
							"",
							"",
							"pm.test(\"ActivityDefinition: Order Medication $apply\", function() {",
							"    pm.response.to.have.status(200)",
							"    _.expectToDeepEqual(pm.response.json(), expected, console)",
							"})"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json+fhir",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"resourceType\": \"Parameters\",\n    \"id\": \"OrderMedicationParameters\",\n    \"parameter\": [\n        {\n            \"name\": \"subject\",\n            \"valueString\": \"Patient/Patient1\"\n        },\n        {\n            \"name\": \"practitioner\",\n            \"valueString\": \"Practitioner/Practitioner1\"\n        },\n        {\n            \"name\": \"encounter\",\n            \"valueString\": \"Encounter/Encounter1\"\n        },\n        {\n        \"name\": \"activityDefinition\",\n        \"resource\": {\n            \"resourceType\": \"ActivityDefinition\",\n            \"id\": \"OrderMedicationActivity\",\n            \"meta\": {\n            \"profile\": [\n                \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-medicationrequestactivity\"\n            ]\n            },\n            \"kind\": \"MedicationRequest\",\n            \"profile\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-medicationrequest\",\n            \"intent\": \"proposal\",\n            \"url\": \"http://example.org/ActivityDefinition/OrderMedicationActivity\",\n            \"name\": \"OrderMedicationActivity\",\n            \"title\": \"ActivityDefinition OrderMedicationActivity\",\n            \"status\": \"draft\",\n            \"experimental\": true,\n            \"publisher\": \"Example\",\n            \"jurisdiction\": [\n            {\n                \"coding\": [\n                {\n                    \"code\": \"001\",\n                    \"system\": \"http://unstats.un.org/unsd/methods/m49/m49.htm\",\n                    \"display\": \"World\"\n                }\n                ]\n            }\n            ],\n            \"version\": \"0.1.0\",\n            \"description\": \"Order a medication activity\",\n            \"code\": {\n            \"coding\": [\n                {\n                \"code\": \"order-medication\",\n                \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",\n                \"display\": \"Order a medication\"\n                }\n            ]\n            },\n            \"priority\": \"routine\",\n            \"doNotPerform\": false,\n            \"productReference\": {\n            \"reference\": \"Medication/PastMedication\"\n            },\n            \"dosage\": [\n            {\n                \"sequence\": 1,\n                \"text\": \"75mcg daily\",\n                \"timing\": {\n                \"repeat\": {\n                    \"frequency\": 1,\n                    \"period\": 1,\n                    \"periodUnit\": \"d\"\n                }\n                },\n                \"route\": {\n                \"coding\": [\n                    {\n                    \"code\": \"26643006\",\n                    \"system\": \"http://snomed.info/sct\",\n                    \"display\": \"Oral Route (qualifier value)\"\n                    }\n                ]\n                },\n                \"doseAndRate\": [\n                {\n                    \"type\": {\n                    \"coding\": [\n                        {\n                        \"code\": \"ordered\",\n                        \"system\": \"http://terminology.hl7.org/CodeSystem/dose-rate-type\",\n                        \"display\": \"Ordered\"\n                        }\n                    ]\n                    },\n                    \"doseQuantity\": {\n                    \"value\": 75,\n                    \"code\": \"ug\",\n                    \"system\": \"http://unitsofmeasure.org\",\n                    \"unit\": \"mcg\"\n                    }\n                }\n                ]\n            }\n            ]\n        }\n        },\n        {\n            \"name\": \"contentEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{contentEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"content\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{contentEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"terminologyEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{terminologyEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"terminology\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{terminologyEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"data\",\n            \"resource\": {\n                \"resourceType\": \"Bundle\",\n                \"id\": \"PatientTestBundle1\",\n                \"type\": \"collection\",\n                \"entry\": [\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Patient\",\n                            \"id\": \"Patient1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Alice\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Encounter\",\n                            \"id\": \"Encounter1\",\n                            \"status\": \"in-progress\",\n                            \"class\": {\n                                \"code\": \"AMB\",\n                                \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"participant\": [\n                                {\n                                    \"individual\": {\n                                        \"reference\": \"Practitioner/Practitioner1\"\n                                    }\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Practitioner\",\n                            \"id\": \"Practitioner1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Michael\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"MedicationRequest\",\n                            \"id\": \"PastMedicationRequest\",\n                            \"status\": \"active\",\n                            \"intent\": \"order\",\n                            \"authoredOn\": \"2023-01-01\",\n                            \"medicationCodeableConcept\": {\n                                \"text\": \"Some medication\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            }\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Medication\",\n                            \"id\": \"CurrentMedication\",\n                            \"status\": \"active\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Medication\",\n                            \"id\": \"PastMedication\",\n                            \"form\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"pill\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Pill\"\n                                    }\n                                ]\n                            },\n                            \"status\": \"inactive\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"DetectedIssue\",\n                            \"id\": \"DetectedIssue1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"TIME\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\",\n                                        \"display\": \"Time-related Detected Issue\"\n                                    }\n                                ]\n                            },\n                            \"severity\": \"high\",\n                            \"patient\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"identifiedDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Condition\",\n                            \"id\": \"Condition1\",\n                            \"clinicalStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"active\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-clinical\"\n                                    }\n                                ]\n                            },\n                            \"verificationStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provisional\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-ver-status\"\n                                    }\n                                ]\n                            },\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"problem-list-item\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/condition-category\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"422504002\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Ischemic stroke (disorder)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"recordedDate\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Observation\",\n                            \"id\": \"Inference1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"text\": \"Inference\",\n                                \"coding\": [\n                                    {\n                                        \"code\": \"448765001\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Unintentional weight loss (finding)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"effectiveDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Flag\",\n                            \"id\": \"Flag1\",\n                            \"status\": \"active\",\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"admin\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/flag-category\",\n                                            \"display\": \"Administrative\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"text\": \"Flag\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"period\": {\n                                \"start\": \"2023-01-01\",\n                                \"end\": \"2024-01-01\"\n                            }\n                        }\n                    }\n                ]\n            }\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{cpgServer}}/ActivityDefinition/$apply",
					"host": [
						"{{cpgServer}}"
					],
					"path": [
						"ActivityDefinition",
						"$apply"
					]
				}
			},
			"response": []
		},
		{
			"name": "ActivityDefinition - OrderServiceParameters",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const expected = {",
							"  \"resourceType\": \"ServiceRequest\",",
							"  \"id\": \"OrderServiceExpected\",",
							"  \"meta\": {",
							"    \"profile\": [",
							"      \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-servicerequest\"",
							"    ]",
							"  },",
							"  \"status\": \"draft\",",
							"  \"doNotPerform\": false,",
							"  \"intent\": \"proposal\",",
							"  \"instantiatesCanonical\": [",
							"    \"http://example.org/ActivityDefinition/OrderServiceActivity|0.1.0\"",
							"  ],",
							"  \"code\": {",
							"    \"coding\": [",
							"      {",
							"        \"code\": \"order-service\",",
							"        \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",",
							"        \"display\": \"Order a service\"",
							"      }",
							"    ]",
							"  },",
							"  \"subject\": {",
							"    \"reference\": \"Patient/Patient1\"",
							"  },",
							"  \"encounter\": {",
							"    \"reference\": \"Encounter/Encounter1\"",
							"  },",
							"  \"requester\": {",
							"    \"reference\": \"Practitioner/Practitioner1\"",
							"  }",
							"}",
							"",
							"",
							"",
							"pm.test(\"ActivityDefinition: Order Service Activity $apply\", function () {",
							"    pm.response.to.have.status(200)",
							"    _.expectToDeepEqual(pm.response.json(), expected, console)",
							"})"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json+fhir",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"resourceType\": \"Parameters\",\n    \"id\": \"OrderServiceParameters\",\n    \"parameter\": [\n        {\n            \"name\": \"subject\",\n            \"valueString\": \"Patient/Patient1\"\n        },\n        {\n            \"name\": \"practitioner\",\n            \"valueString\": \"Practitioner/Practitioner1\"\n        },\n        {\n            \"name\": \"encounter\",\n            \"valueString\": \"Encounter/Encounter1\"\n        },\n        {\n        \"name\": \"activityDefinition\",\n        \"resource\": {\n            \"resourceType\": \"ActivityDefinition\",\n            \"id\": \"OrderServiceActivity\",\n            \"meta\": {\n            \"profile\": [\n                \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-servicerequestactivity\"\n            ]\n            },\n            \"kind\": \"ServiceRequest\",\n            \"profile\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-servicerequest\",\n            \"intent\": \"proposal\",\n            \"url\": \"http://example.org/ActivityDefinition/OrderServiceActivity\",\n            \"name\": \"OrderServiceActivity\",\n            \"title\": \"ActivityDefinition OrderServiceActivity\",\n            \"status\": \"draft\",\n            \"experimental\": true,\n            \"publisher\": \"Example\",\n            \"jurisdiction\": [\n            {\n                \"coding\": [\n                {\n                    \"code\": \"001\",\n                    \"system\": \"http://unstats.un.org/unsd/methods/m49/m49.htm\",\n                    \"display\": \"World\"\n                }\n                ]\n            }\n            ],\n            \"version\": \"0.1.0\",\n            \"description\": \"Example Activity Definition for a recommendation to order a service\",\n            \"code\": {\n            \"coding\": [\n                {\n                \"code\": \"order-service\",\n                \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",\n                \"display\": \"Order a service\"\n                }\n            ]\n            },\n            \"doNotPerform\": false\n        }\n        },\n        {\n            \"name\": \"contentEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{contentEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"content\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{contentEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"terminologyEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{terminologyEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"terminology\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{terminologyEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"data\",\n            \"resource\": {\n                \"resourceType\": \"Bundle\",\n                \"id\": \"PatientTestBundle1\",\n                \"type\": \"collection\",\n                \"entry\": [\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Patient\",\n                            \"id\": \"Patient1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Alice\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Encounter\",\n                            \"id\": \"Encounter1\",\n                            \"status\": \"in-progress\",\n                            \"class\": {\n                                \"code\": \"AMB\",\n                                \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"participant\": [\n                                {\n                                    \"individual\": {\n                                        \"reference\": \"Practitioner/Practitioner1\"\n                                    }\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Practitioner\",\n                            \"id\": \"Practitioner1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Michael\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"MedicationRequest\",\n                            \"id\": \"PastMedicationRequest\",\n                            \"status\": \"active\",\n                            \"intent\": \"order\",\n                            \"authoredOn\": \"2023-01-01\",\n                            \"medicationCodeableConcept\": {\n                                \"text\": \"Some medication\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            }\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"DetectedIssue\",\n                            \"id\": \"DetectedIssue1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"TIME\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\",\n                                        \"display\": \"Time-related Detected Issue\"\n                                    }\n                                ]\n                            },\n                            \"severity\": \"high\",\n                            \"patient\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"identifiedDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Condition\",\n                            \"id\": \"Condition1\",\n                            \"clinicalStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"active\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-clinical\"\n                                    }\n                                ]\n                            },\n                            \"verificationStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provisional\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-ver-status\"\n                                    }\n                                ]\n                            },\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"problem-list-item\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/condition-category\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"422504002\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Ischemic stroke (disorder)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"recordedDate\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Observation\",\n                            \"id\": \"Inference1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"text\": \"Inference\",\n                                \"coding\": [\n                                    {\n                                        \"code\": \"448765001\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Unintentional weight loss (finding)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"effectiveDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Flag\",\n                            \"id\": \"Flag1\",\n                            \"status\": \"active\",\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"admin\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/flag-category\",\n                                            \"display\": \"Administrative\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"text\": \"Flag\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"period\": {\n                                \"start\": \"2023-01-01\",\n                                \"end\": \"2024-01-01\"\n                            }\n                        }\n                    }\n                ]\n            }\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{cpgServer}}/ActivityDefinition/$apply",
					"host": [
						"{{cpgServer}}"
					],
					"path": [
						"ActivityDefinition",
						"$apply"
					]
				}
			},
			"response": []
		},
		{
			"name": "ActivityDefinition - ProposeDiagnosisParameters",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const expected = {",
							"  \"resourceType\": \"Task\",",
							"  \"id\": \"ProposeDiagnosisExpected\",",
							"  \"meta\": {",
							"    \"profile\": [",
							"      \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-proposediagnosistask\"",
							"    ]",
							"  },",
							"  \"input\": [",
							"    {",
							"      \"type\": {",
							"        \"coding\": [",
							"          {",
							"            \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",",
							"            \"code\": \"propose-diagnosis\",",
							"            \"display\": \"Propose a diagnosis\"",
							"          }",
							"        ]",
							"      },",
							"      \"valueReference\": {",
							"        \"reference\": \"Condition/Condition1\"",
							"      }",
							"    }",
							"  ],",
							"  \"status\": \"draft\",",
							"  \"intent\": \"proposal\",",
							"  \"instantiatesCanonical\": \"http://example.org/ActivityDefinition/ProposeDiagnosisActivity|0.1.0\",",
							"  \"code\": {",
							"    \"coding\": [",
							"      {",
							"        \"code\": \"propose-diagnosis\",",
							"        \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",",
							"        \"display\": \"Propose a diagnosis\"",
							"      }",
							"    ]",
							"  },",
							"  \"for\": {",
							"    \"reference\": \"Patient/Patient1\"",
							"  },",
							"  \"encounter\": {",
							"    \"reference\": \"Encounter/Encounter1\"",
							"  },",
							"  \"requester\": {",
							"    \"reference\": \"Practitioner/Practitioner1\"",
							"  }",
							"}",
							"",
							"",
							"",
							"pm.test(\"ActivityDefinition: Propose Diagnosis Activity $apply\", function () {",
							"    pm.response.to.have.status(200)",
							"    _.expectToDeepEqual(pm.response.json(), expected, console)",
							"})"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json+fhir",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"resourceType\": \"Parameters\",\n    \"id\": \"ProposeDiagnosisParameters\",\n    \"parameter\": [\n        {\n            \"name\": \"subject\",\n            \"valueString\": \"Patient/Patient1\"\n        },\n        {\n            \"name\": \"practitioner\",\n            \"valueString\": \"Practitioner/Practitioner1\"\n        },\n        {\n            \"name\": \"encounter\",\n            \"valueString\": \"Encounter/Encounter1\"\n        },\n        {\n        \"name\": \"activityDefinition\",\n        \"resource\": {\n            \"resourceType\": \"ActivityDefinition\",\n            \"id\": \"ProposeDiagnosisActivity\",\n            \"meta\": {\n            \"profile\": [\n                \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-proposediagnosisactivity\"\n            ]\n            },\n            \"kind\": \"Task\",\n            \"profile\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-proposediagnosistask\",\n            \"intent\": \"proposal\",\n            \"url\": \"http://example.org/ActivityDefinition/ProposeDiagnosisActivity\",\n            \"name\": \"ProposeDiagnosisActivity\",\n            \"title\": \"ActivityDefinition ProposeDiagnosisActivity\",\n            \"status\": \"draft\",\n            \"experimental\": true,\n            \"publisher\": \"Example\",\n            \"jurisdiction\": [\n            {\n                \"coding\": [\n                {\n                    \"code\": \"001\",\n                    \"system\": \"http://unstats.un.org/unsd/methods/m49/m49.htm\",\n                    \"display\": \"World\"\n                }\n                ]\n            }\n            ],\n            \"version\": \"0.1.0\",\n            \"description\": \"Example Activity Definition for a recommendation to propose a diagnosis\",\n            \"code\": {\n            \"coding\": [\n                {\n                \"code\": \"propose-diagnosis\",\n                \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",\n                \"display\": \"Propose a diagnosis\"\n                }\n            ]\n            },\n            \"doNotPerform\": false,\n            \"dynamicValue\": [\n            {\n                \"path\": \"input[0].type\",\n                \"expression\": {\n                \"language\": \"text/fhirpath\",\n                \"expression\": \"%context.code\"\n                }\n            },\n            {\n                \"path\": \"input[0].valueReference\",\n                \"expression\": {\n                \"language\": \"text/cql-identifier\",\n                \"expression\": \"Propose Diagnosis Reference\",\n                \"reference\": \"http://example.org/Library/ProposeDiagnosisLibrary\"\n                }\n            }\n            ]\n        }\n        },\n        {\n            \"name\": \"contentEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{contentEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"content\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{contentEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"terminologyEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{terminologyEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"terminology\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{terminologyEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"data\",\n            \"resource\": {\n                \"resourceType\": \"Bundle\",\n                \"id\": \"PatientTestBundle1\",\n                \"type\": \"collection\",\n                \"entry\": [\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Patient\",\n                            \"id\": \"Patient1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Alice\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Encounter\",\n                            \"id\": \"Encounter1\",\n                            \"status\": \"in-progress\",\n                            \"class\": {\n                                \"code\": \"AMB\",\n                                \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"participant\": [\n                                {\n                                    \"individual\": {\n                                        \"reference\": \"Practitioner/Practitioner1\"\n                                    }\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Practitioner\",\n                            \"id\": \"Practitioner1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Michael\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"MedicationRequest\",\n                            \"id\": \"PastMedicationRequest\",\n                            \"status\": \"active\",\n                            \"intent\": \"order\",\n                            \"authoredOn\": \"2023-01-01\",\n                            \"medicationCodeableConcept\": {\n                                \"text\": \"Some medication\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            }\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"DetectedIssue\",\n                            \"id\": \"DetectedIssue1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"TIME\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\",\n                                        \"display\": \"Time-related Detected Issue\"\n                                    }\n                                ]\n                            },\n                            \"severity\": \"high\",\n                            \"patient\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"identifiedDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Condition\",\n                            \"id\": \"Condition1\",\n                            \"clinicalStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"active\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-clinical\"\n                                    }\n                                ]\n                            },\n                            \"verificationStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provisional\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-ver-status\"\n                                    }\n                                ]\n                            },\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"problem-list-item\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/condition-category\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"422504002\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Ischemic stroke (disorder)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"recordedDate\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Observation\",\n                            \"id\": \"Inference1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"text\": \"Inference\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"effectiveDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Flag\",\n                            \"id\": \"Flag1\",\n                            \"status\": \"active\",\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"admin\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/flag-category\",\n                                            \"display\": \"Administrative\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"text\": \"Flag\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"period\": {\n                                \"start\": \"2023-01-01\",\n                                \"end\": \"2024-01-01\"\n                            }\n                        }\n                    }\n                ]\n            }\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{cpgServer}}/ActivityDefinition/$apply",
					"host": [
						"{{cpgServer}}"
					],
					"path": [
						"ActivityDefinition",
						"$apply"
					]
				}
			},
			"response": []
		},
		{
			"name": "ActivityDefinition - RecommendImmunizationParameters",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const expected = {",
							"  \"resourceType\": \"MedicationRequest\",",
							"  \"id\": \"RecommendImmunizationExpected\",",
							"  \"meta\": {",
							"    \"profile\": [",
							"      \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-immunizationrequest\"",
							"    ]",
							"  },",
							"  \"status\": \"draft\",",
							"  \"intent\": \"proposal\",",
							"      \"instantiatesCanonical\": [",
							"        \"http://example.org/ActivityDefinition/RecommendImmunizationActivity|0.1.0\"",
							"  ],",
							"  \"category\": [",
							"    {",
							"      \"coding\": [",
							"        {",
							"          \"code\": \"recommend-immunization\",",
							"          \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\"",
							"        }",
							"      ]",
							"    }",
							"  ],",
							"  \"subject\": {",
							"    \"reference\": \"Patient/Patient1\"",
							"  },",
							"  \"encounter\": {",
							"    \"reference\": \"Encounter/Encounter1\"",
							"  },",
							"  \"requester\": {",
							"    \"reference\": \"Practitioner/Practitioner1\"",
							"  },",
							"  \"doNotPerform\": false,",
							"  \"medicationCodeableConcept\": {",
							"    \"coding\": [",
							"      {",
							"        \"code\": \"14745005\",",
							"        \"system\": \"http://snomed.info/sct\",",
							"        \"display\": \"Hepatitis A vaccine\"",
							"      }",
							"    ]",
							"  }",
							"}",
							"",
							"pm.test(\"ActivityDefinition: Recommend Immunization Activity $apply\", function () {",
							"    pm.response.to.have.status(200)",
							"    _.expectToDeepEqual(pm.response.json(), expected, console)",
							"})"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json+fhir",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"resourceType\": \"Parameters\",\n    \"id\": \"RecommendImmunizationParameters\",\n    \"parameter\": [\n        {\n            \"name\": \"subject\",\n            \"valueString\": \"Patient/Patient1\"\n        },\n        {\n            \"name\": \"practitioner\",\n            \"valueString\": \"Practitioner/Practitioner1\"\n        },\n        {\n            \"name\": \"encounter\",\n            \"valueString\": \"Encounter/Encounter1\"\n        },\n        {\n        \"name\": \"activityDefinition\",\n        \"resource\": {\n            \"resourceType\": \"ActivityDefinition\",\n            \"id\": \"RecommendImmunizationActivity\",\n            \"meta\": {\n            \"profile\": [\n                \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-immunizationactivity\"\n            ]\n            },\n            \"kind\": \"MedicationRequest\",\n            \"profile\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-immunizationrequest\",\n            \"intent\": \"proposal\",\n            \"url\": \"http://example.org/ActivityDefinition/RecommendImmunizationActivity\",\n            \"name\": \"RecommendImmunizationActivity\",\n            \"title\": \"ActivityDefinition RecommendImmunizationActivity\",\n            \"status\": \"draft\",\n            \"experimental\": true,\n            \"publisher\": \"Example\",\n            \"jurisdiction\": [\n            {\n                \"coding\": [\n                {\n                    \"code\": \"001\",\n                    \"system\": \"http://unstats.un.org/unsd/methods/m49/m49.htm\",\n                    \"display\": \"World\"\n                }\n                ]\n            }\n            ],\n            \"version\": \"0.1.0\",\n            \"description\": \"Example Activity Definition for a recommendation to provide an immunization\",\n            \"code\": {\n            \"coding\": [\n                {\n                \"code\": \"recommend-immunization\",\n                \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\"\n                }\n            ]\n            },\n            \"priority\": \"routine\",\n            \"doNotPerform\": false,\n            \"productCodeableConcept\": {\n            \"coding\": [\n                {\n                \"code\": \"14745005\",\n                \"system\": \"http://snomed.info/sct\",\n                \"display\": \"Hepatitis A vaccine\"\n                }\n            ]\n            }\n        }\n        },\n        {\n            \"name\": \"contentEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{contentEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"content\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{contentEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"terminologyEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{terminologyEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"terminology\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{terminologyEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"data\",\n            \"resource\": {\n                \"resourceType\": \"Bundle\",\n                \"id\": \"PatientTestBundle1\",\n                \"type\": \"collection\",\n                \"entry\": [\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Patient\",\n                            \"id\": \"Patient1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Alice\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Encounter\",\n                            \"id\": \"Encounter1\",\n                            \"status\": \"in-progress\",\n                            \"class\": {\n                                \"code\": \"AMB\",\n                                \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"participant\": [\n                                {\n                                    \"individual\": {\n                                        \"reference\": \"Practitioner/Practitioner1\"\n                                    }\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Practitioner\",\n                            \"id\": \"Practitioner1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Michael\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"MedicationRequest\",\n                            \"id\": \"PastMedicationRequest\",\n                            \"status\": \"active\",\n                            \"intent\": \"order\",\n                            \"authoredOn\": \"2023-01-01\",\n                            \"medicationCodeableConcept\": {\n                                \"text\": \"Some medication\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            }\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"DetectedIssue\",\n                            \"id\": \"DetectedIssue1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"TIME\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\",\n                                        \"display\": \"Time-related Detected Issue\"\n                                    }\n                                ]\n                            },\n                            \"severity\": \"high\",\n                            \"patient\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"identifiedDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Condition\",\n                            \"id\": \"Condition1\",\n                            \"clinicalStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"active\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-clinical\"\n                                    }\n                                ]\n                            },\n                            \"verificationStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provisional\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-ver-status\"\n                                    }\n                                ]\n                            },\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"problem-list-item\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/condition-category\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"422504002\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Ischemic stroke (disorder)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"recordedDate\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Observation\",\n                            \"id\": \"Inference1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"text\": \"Inference\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"effectiveDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Flag\",\n                            \"id\": \"Flag1\",\n                            \"status\": \"active\",\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"admin\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/flag-category\",\n                                            \"display\": \"Administrative\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"text\": \"Flag\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"period\": {\n                                \"start\": \"2023-01-01\",\n                                \"end\": \"2024-01-01\"\n                            }\n                        }\n                    }\n                ]\n            }\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{cpgServer}}/ActivityDefinition/$apply",
					"host": [
						"{{cpgServer}}"
					],
					"path": [
						"ActivityDefinition",
						"$apply"
					]
				}
			},
			"response": []
		},
		{
			"name": "ActivityDefinition - RecordDetectedIssueParameters",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const expected = {",
							"  \"resourceType\": \"Task\",",
							"  \"id\": \"RecordDetectedIssueExpected\",",
							"  \"meta\": {",
							"    \"profile\": [",
							"      \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-recorddetectedissuetask\"",
							"    ]",
							"  },",
							"  \"input\": [",
							"    {",
							"      \"type\": {",
							"        \"coding\": [",
							"          {",
							"            \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",",
							"            \"code\": \"record-detected-issue\",",
							"            \"display\": \"Record a detected issue\"",
							"          }",
							"        ]",
							"      },",
							"      \"valueReference\": {",
							"        \"reference\": \"DetectedIssue/DetectedIssue1\"",
							"      }",
							"    }",
							"  ],",
							"  \"status\": \"draft\",",
							"  \"intent\": \"proposal\",",
							"  \"instantiatesCanonical\": \"http://example.org/ActivityDefinition/RecordDetectedIssueActivity|0.1.0\",",
							"  \"code\": {",
							"    \"coding\": [",
							"      {",
							"        \"code\": \"record-detected-issue\",",
							"        \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",",
							"        \"display\": \"Record a detected issue\"",
							"      }",
							"    ]",
							"  },",
							"  \"for\": {",
							"    \"reference\": \"Patient/Patient1\"",
							"  },",
							"  \"encounter\": {",
							"    \"reference\": \"Encounter/Encounter1\"",
							"  },",
							"  \"requester\": {",
							"    \"reference\": \"Practitioner/Practitioner1\"",
							"  }",
							"}",
							"",
							"",
							"",
							"pm.test(\"ActivityDefinition: Record Detected Issue Activity $apply\", function () {",
							"    pm.response.to.have.status(200)",
							"    _.expectToDeepEqual(pm.response.json(), expected, console)",
							"})"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json+fhir",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"resourceType\": \"Parameters\",\n    \"id\": \"RecordDetectedIssueParameters\",\n    \"parameter\": [\n        {\n            \"name\": \"subject\",\n            \"valueString\": \"Patient/Patient1\"\n        },\n        {\n            \"name\": \"practitioner\",\n            \"valueString\": \"Practitioner/Practitioner1\"\n        },\n        {\n            \"name\": \"encounter\",\n            \"valueString\": \"Encounter/Encounter1\"\n        },\n        {\n        \"name\": \"activityDefinition\",\n        \"resource\": {\n            \"resourceType\": \"ActivityDefinition\",\n            \"id\": \"RecordDetectedIssueActivity\",\n            \"meta\": {\n            \"profile\": [\n                \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-recorddetectedissueactivity\"\n            ]\n            },\n            \"kind\": \"Task\",\n            \"profile\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-recorddetectedissuetask\",\n            \"intent\": \"proposal\",\n            \"url\": \"http://example.org/ActivityDefinition/RecordDetectedIssueActivity\",\n            \"name\": \"RecordDetectedIssueActivity\",\n            \"title\": \"ActivityDefinition RecordDetectedIssueActivity\",\n            \"status\": \"draft\",\n            \"experimental\": true,\n            \"publisher\": \"Example\",\n            \"jurisdiction\": [\n            {\n                \"coding\": [\n                {\n                    \"code\": \"001\",\n                    \"system\": \"http://unstats.un.org/unsd/methods/m49/m49.htm\",\n                    \"display\": \"World\"\n                }\n                ]\n            }\n            ],\n            \"version\": \"0.1.0\",\n            \"description\": \"Example Activity Definition for a recommendation to record a detected issue\",\n            \"code\": {\n            \"coding\": [\n                {\n                \"code\": \"record-detected-issue\",\n                \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",\n                \"display\": \"Record a detected issue\"\n                }\n            ]\n            },\n            \"doNotPerform\": false,\n            \"dynamicValue\": [\n            {\n                \"path\": \"input[0].type\",\n                \"expression\": {\n                \"language\": \"text/fhirpath\",\n                \"expression\": \"%context.code\"\n                }\n            },\n            {\n                \"path\": \"input[0].valueReference\",\n                \"expression\": {\n                \"language\": \"text/cql-identifier\",\n                \"expression\": \"Record Detected Issue Reference\",\n                \"reference\": \"http://example.org/Library/RecordDetectedIssueLibrary\"\n                }\n            }\n            ]\n        }\n        },\n        {\n            \"name\": \"contentEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{contentEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"content\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{contentEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"terminologyEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{terminologyEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"terminology\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{terminologyEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"data\",\n            \"resource\": {\n                \"resourceType\": \"Bundle\",\n                \"id\": \"PatientTestBundle1\",\n                \"type\": \"collection\",\n                \"entry\": [\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Patient\",\n                            \"id\": \"Patient1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Alice\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Encounter\",\n                            \"id\": \"Encounter1\",\n                            \"status\": \"in-progress\",\n                            \"class\": {\n                                \"code\": \"AMB\",\n                                \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"participant\": [\n                                {\n                                    \"individual\": {\n                                        \"reference\": \"Practitioner/Practitioner1\"\n                                    }\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Practitioner\",\n                            \"id\": \"Practitioner1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Michael\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"MedicationRequest\",\n                            \"id\": \"PastMedicationRequest\",\n                            \"status\": \"active\",\n                            \"intent\": \"order\",\n                            \"authoredOn\": \"2023-01-01\",\n                            \"medicationCodeableConcept\": {\n                                \"text\": \"Some medication\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            }\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"DetectedIssue\",\n                            \"id\": \"DetectedIssue1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"TIME\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\",\n                                        \"display\": \"Time-related Detected Issue\"\n                                    }\n                                ]\n                            },\n                            \"severity\": \"high\",\n                            \"patient\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"identifiedDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Condition\",\n                            \"id\": \"Condition1\",\n                            \"clinicalStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"active\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-clinical\"\n                                    }\n                                ]\n                            },\n                            \"verificationStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provisional\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-ver-status\"\n                                    }\n                                ]\n                            },\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"problem-list-item\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/condition-category\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"422504002\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Ischemic stroke (disorder)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"recordedDate\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Observation\",\n                            \"id\": \"Inference1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"text\": \"Inference\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"effectiveDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Flag\",\n                            \"id\": \"Flag1\",\n                            \"status\": \"active\",\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"admin\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/flag-category\",\n                                            \"display\": \"Administrative\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"text\": \"Flag\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"period\": {\n                                \"start\": \"2023-01-01\",\n                                \"end\": \"2024-01-01\"\n                            }\n                        }\n                    }\n                ]\n            }\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{cpgServer}}/ActivityDefinition/$apply",
					"host": [
						"{{cpgServer}}"
					],
					"path": [
						"ActivityDefinition",
						"$apply"
					]
				}
			},
			"response": []
		},
		{
			"name": "ActivityDefinition - RecordInferenceParameters",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const expected = {",
							"  \"resourceType\": \"Task\",",
							"  \"id\": \"RecordInferenceExpected\",",
							"  \"meta\": {",
							"    \"profile\": [",
							"      \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-recordinferencetask\"",
							"    ]",
							"  },",
							"  \"input\": [",
							"    {",
							"      \"type\": {",
							"        \"coding\": [",
							"          {",
							"            \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",",
							"            \"code\": \"record-inference\",",
							"            \"display\": \"Record an inference\"",
							"          }",
							"        ]",
							"      },",
							"      \"valueReference\": {",
							"        \"reference\": \"Observation/Inference1\"",
							"      }",
							"    }",
							"  ],",
							"  \"status\": \"draft\",",
							"  \"intent\": \"proposal\",",
							"  \"instantiatesCanonical\": \"http://example.org/ActivityDefinition/RecordInferenceActivity|0.1.0\",",
							"  \"code\": {",
							"    \"coding\": [",
							"      {",
							"        \"code\": \"record-inference\",",
							"        \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",",
							"        \"display\": \"Record an inference\"",
							"      }",
							"    ]",
							"  },",
							"  \"for\": {",
							"    \"reference\": \"Patient/Patient1\"",
							"  },",
							"  \"encounter\": {",
							"    \"reference\": \"Encounter/Encounter1\"",
							"  },",
							"  \"requester\": {",
							"    \"reference\": \"Practitioner/Practitioner1\"",
							"  }",
							"}",
							"",
							"",
							"",
							"pm.test(\"ActivityDefinition: Record Inference Activity $apply\", function () {",
							"    pm.response.to.have.status(200)",
							"    _.expectToDeepEqual(pm.response.json(), expected, console)",
							"})"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json+fhir",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"resourceType\": \"Parameters\",\n    \"id\": \"RecordInferenceParameters\",\n    \"parameter\": [\n        {\n            \"name\": \"subject\",\n            \"valueString\": \"Patient/Patient1\"\n        },\n        {\n            \"name\": \"practitioner\",\n            \"valueString\": \"Practitioner/Practitioner1\"\n        },\n        {\n            \"name\": \"encounter\",\n            \"valueString\": \"Encounter/Encounter1\"\n        },\n        {\n        \"name\": \"activityDefinition\",\n        \"resource\": {\n            \"resourceType\": \"ActivityDefinition\",\n            \"id\": \"RecordInferenceActivity\",\n            \"meta\": {\n            \"profile\": [\n                \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-recordinferenceactivity\"\n            ]\n            },\n            \"kind\": \"Task\",\n            \"profile\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-recordinferencetask\",\n            \"intent\": \"proposal\",\n            \"url\": \"http://example.org/ActivityDefinition/RecordInferenceActivity\",\n            \"name\": \"RecordInferenceActivity\",\n            \"title\": \"ActivityDefinition RecordInferenceActivity\",\n            \"status\": \"draft\",\n            \"experimental\": true,\n            \"publisher\": \"Example\",\n            \"jurisdiction\": [\n            {\n                \"coding\": [\n                {\n                    \"code\": \"001\",\n                    \"system\": \"http://unstats.un.org/unsd/methods/m49/m49.htm\",\n                    \"display\": \"World\"\n                }\n                ]\n            }\n            ],\n            \"version\": \"0.1.0\",\n            \"description\": \"Example Activity Definition for a recommendation to record an inference\",\n            \"code\": {\n            \"coding\": [\n                {\n                \"code\": \"record-inference\",\n                \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",\n                \"display\": \"Record an inference\"\n                }\n            ]\n            },\n            \"doNotPerform\": false,\n            \"dynamicValue\": [\n            {\n                \"path\": \"input[0].type\",\n                \"expression\": {\n                \"language\": \"text/fhirpath\",\n                \"expression\": \"%context.code\"\n                }\n            },\n            {\n                \"path\": \"input[0].valueReference\",\n                \"expression\": {\n                \"language\": \"text/cql-identifier\",\n                \"expression\": \"Record Inference Reference\",\n                \"reference\": \"http://example.org/Library/RecordInferenceLibrary\"\n                }\n            }\n            ]\n        }\n        },\n        {\n            \"name\": \"contentEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{contentEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"content\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{contentEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"terminologyEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{terminologyEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"terminology\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{terminologyEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"data\",\n            \"resource\": {\n                \"resourceType\": \"Bundle\",\n                \"id\": \"PatientTestBundle1\",\n                \"type\": \"collection\",\n                \"entry\": [\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Patient\",\n                            \"id\": \"Patient1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Alice\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Encounter\",\n                            \"id\": \"Encounter1\",\n                            \"status\": \"in-progress\",\n                            \"class\": {\n                                \"code\": \"AMB\",\n                                \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"participant\": [\n                                {\n                                    \"individual\": {\n                                        \"reference\": \"Practitioner/Practitioner1\"\n                                    }\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Practitioner\",\n                            \"id\": \"Practitioner1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Michael\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"MedicationRequest\",\n                            \"id\": \"PastMedicationRequest\",\n                            \"status\": \"active\",\n                            \"intent\": \"order\",\n                            \"authoredOn\": \"2023-01-01\",\n                            \"medicationCodeableConcept\": {\n                                \"text\": \"Some medication\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            }\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"DetectedIssue\",\n                            \"id\": \"DetectedIssue1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"TIME\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\",\n                                        \"display\": \"Time-related Detected Issue\"\n                                    }\n                                ]\n                            },\n                            \"severity\": \"high\",\n                            \"patient\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"identifiedDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Condition\",\n                            \"id\": \"Condition1\",\n                            \"clinicalStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"active\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-clinical\"\n                                    }\n                                ]\n                            },\n                            \"verificationStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provisional\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-ver-status\"\n                                    }\n                                ]\n                            },\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"problem-list-item\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/condition-category\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"422504002\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Ischemic stroke (disorder)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"recordedDate\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Observation\",\n                            \"id\": \"Inference1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"text\": \"Inference\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"effectiveDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Flag\",\n                            \"id\": \"Flag1\",\n                            \"status\": \"active\",\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"admin\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/flag-category\",\n                                            \"display\": \"Administrative\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"text\": \"Flag\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"period\": {\n                                \"start\": \"2023-01-01\",\n                                \"end\": \"2024-01-01\"\n                            }\n                        }\n                    }\n                ]\n            }\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{cpgServer}}/ActivityDefinition/$apply",
					"host": [
						"{{cpgServer}}"
					],
					"path": [
						"ActivityDefinition",
						"$apply"
					]
				}
			},
			"response": []
		},
		{
			"name": "ActivityDefinition - ReportFlagParameters",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const expected = {",
							"  \"resourceType\": \"Task\",",
							"  \"id\": \"ReportFlagExpected\",",
							"  \"meta\": {",
							"    \"profile\": [",
							"      \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-reportflagtask\"",
							"    ]",
							"  },",
							"  \"input\": [",
							"    {",
							"      \"type\": {",
							"        \"coding\": [",
							"          {",
							"            \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",",
							"            \"code\": \"report-flag\",",
							"            \"display\": \"Report a flag\"",
							"          }",
							"        ]",
							"      },",
							"      \"valueReference\": {",
							"        \"reference\": \"Flag/Flag1\"",
							"      }",
							"    }",
							"  ],",
							"  \"status\": \"draft\",",
							"  \"intent\": \"proposal\",",
							"  \"instantiatesCanonical\": \"http://example.org/ActivityDefinition/ReportFlagActivity|0.1.0\",",
							"  \"code\": {",
							"    \"coding\": [",
							"      {",
							"        \"code\": \"report-flag\",",
							"        \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",",
							"        \"display\": \"Report a flag\"",
							"      }",
							"    ]",
							"  },",
							"  \"for\": {",
							"    \"reference\": \"Patient/Patient1\"",
							"  },",
							"  \"encounter\": {",
							"    \"reference\": \"Encounter/Encounter1\"",
							"  },",
							"  \"requester\": {",
							"    \"reference\": \"Practitioner/Practitioner1\"",
							"  }",
							"}",
							"",
							"",
							"",
							"pm.test(\"ActivityDefinition: Report Flag Activity $apply\", function () {",
							"    pm.response.to.have.status(200)",
							"    _.expectToDeepEqual(pm.response.json(), expected, console)",
							"})"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json+fhir",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"resourceType\": \"Parameters\",\n    \"id\": \"ReportFlagParameters\",\n    \"parameter\": [\n        {\n            \"name\": \"subject\",\n            \"valueString\": \"Patient/Patient1\"\n        },\n        {\n            \"name\": \"practitioner\",\n            \"valueString\": \"Practitioner/Practitioner1\"\n        },\n        {\n            \"name\": \"encounter\",\n            \"valueString\": \"Encounter/Encounter1\"\n        },\n        {\n        \"name\": \"activityDefinition\",\n        \"resource\": {\n            \"resourceType\": \"ActivityDefinition\",\n            \"id\": \"ReportFlagActivity\",\n            \"meta\": {\n            \"profile\": [\n                \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-reportflagactivity\"\n            ]\n            },\n            \"kind\": \"Task\",\n            \"profile\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-reportflagtask\",\n            \"intent\": \"proposal\",\n            \"url\": \"http://example.org/ActivityDefinition/ReportFlagActivity\",\n            \"name\": \"ReportFlagActivity\",\n            \"title\": \"ActivityDefinition ReportFlagActivity\",\n            \"status\": \"draft\",\n            \"experimental\": true,\n            \"publisher\": \"Example\",\n            \"jurisdiction\": [\n            {\n                \"coding\": [\n                {\n                    \"code\": \"001\",\n                    \"system\": \"http://unstats.un.org/unsd/methods/m49/m49.htm\",\n                    \"display\": \"World\"\n                }\n                ]\n            }\n            ],\n            \"version\": \"0.1.0\",\n            \"description\": \"Example Activity Definition for a recommendation to report a flag\",\n            \"code\": {\n            \"coding\": [\n                {\n                \"code\": \"report-flag\",\n                \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",\n                \"display\": \"Report a flag\"\n                }\n            ]\n            },\n            \"doNotPerform\": false,\n            \"dynamicValue\": [\n            {\n                \"path\": \"input[0].type\",\n                \"expression\": {\n                \"language\": \"text/fhirpath\",\n                \"expression\": \"%context.code\"\n                }\n            },\n            {\n                \"path\": \"input[0].valueReference\",\n                \"expression\": {\n                \"language\": \"text/cql-identifier\",\n                \"expression\": \"Report Flag Reference\",\n                \"reference\": \"http://example.org/Library/ReportFlagLibrary\"\n                }\n            }\n            ]\n        }\n        },\n        {\n            \"name\": \"contentEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{contentEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"content\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{contentEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"terminologyEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{terminologyEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"terminology\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{terminologyEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"data\",\n            \"resource\": {\n                \"resourceType\": \"Bundle\",\n                \"id\": \"PatientTestBundle1\",\n                \"type\": \"collection\",\n                \"entry\": [\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Patient\",\n                            \"id\": \"Patient1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Alice\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Encounter\",\n                            \"id\": \"Encounter1\",\n                            \"status\": \"in-progress\",\n                            \"class\": {\n                                \"code\": \"AMB\",\n                                \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"participant\": [\n                                {\n                                    \"individual\": {\n                                        \"reference\": \"Practitioner/Practitioner1\"\n                                    }\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Practitioner\",\n                            \"id\": \"Practitioner1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Michael\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"MedicationRequest\",\n                            \"id\": \"PastMedicationRequest\",\n                            \"status\": \"active\",\n                            \"intent\": \"order\",\n                            \"authoredOn\": \"2023-01-01\",\n                            \"medicationCodeableConcept\": {\n                                \"text\": \"Some medication\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            }\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"DetectedIssue\",\n                            \"id\": \"DetectedIssue1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"TIME\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\",\n                                        \"display\": \"Time-related Detected Issue\"\n                                    }\n                                ]\n                            },\n                            \"severity\": \"high\",\n                            \"patient\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"identifiedDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Condition\",\n                            \"id\": \"Condition1\",\n                            \"clinicalStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"active\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-clinical\"\n                                    }\n                                ]\n                            },\n                            \"verificationStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provisional\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-ver-status\"\n                                    }\n                                ]\n                            },\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"problem-list-item\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/condition-category\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"422504002\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Ischemic stroke (disorder)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"recordedDate\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Observation\",\n                            \"id\": \"Inference1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"text\": \"Inference\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"effectiveDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Flag\",\n                            \"id\": \"Flag1\",\n                            \"status\": \"active\",\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"admin\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/flag-category\",\n                                            \"display\": \"Administrative\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"text\": \"Flag\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"period\": {\n                                \"start\": \"2023-01-01\",\n                                \"end\": \"2024-01-01\"\n                            }\n                        }\n                    }\n                ]\n            }\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{cpgServer}}/ActivityDefinition/$apply",
					"host": [
						"{{cpgServer}}"
					],
					"path": [
						"ActivityDefinition",
						"$apply"
					]
				}
			},
			"response": []
		},
		{
			"name": "ActivityDefinition - SendMessageParameters",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const expected = {",
							"  \"resourceType\": \"CommunicationRequest\",",
							"  \"id\": \"SendMessageExpected\",",
							"  \"meta\": {",
							"    \"profile\": [",
							"      \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-communicationrequest\"",
							"    ]",
							"  },",
							"  \"status\": \"draft\",",
							"  \"doNotPerform\": false,",
							"  \"subject\": {",
							"    \"reference\": \"Patient/Patient1\"",
							"  },",
							"  \"encounter\": {",
							"    \"reference\": \"Encounter/Encounter1\"",
							"  },",
							"  \"requester\": {",
							"    \"reference\": \"Practitioner/Practitioner1\"",
							"  },",
							"  \"payload\": [",
							"    {",
							"      \"contentString\": \"Greeting: Hello! Alice Message: Example Activity Definition for a recommendation to send a message Practitioner: Michael\"",
							"    }",
							"  ]",
							"}",
							"",
							"",
							"",
							"pm.test(\"ActivityDefinition: Send Message Activity $apply\", function() {",
							"    pm.response.to.have.status(200)",
							"    _.expectToDeepEqual(pm.response.json(), expected, console)",
							"})"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json+fhir",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"resourceType\": \"Parameters\",\n    \"id\": \"SendMessageParameters\",\n    \"parameter\": [\n        {\n            \"name\": \"subject\",\n            \"valueString\": \"Patient/Patient1\"\n        },\n        {\n            \"name\": \"practitioner\",\n            \"valueString\": \"Practitioner/Practitioner1\"\n        },\n        {\n            \"name\": \"encounter\",\n            \"valueString\": \"Encounter/Encounter1\"\n        },\n        {\n        \"name\": \"activityDefinition\",\n        \"resource\": {\n            \"resourceType\": \"ActivityDefinition\",\n            \"id\": \"SendMessageActivity\",\n            \"meta\": {\n            \"profile\": [\n                \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-communicationactivity\"\n            ]\n            },\n            \"kind\": \"CommunicationRequest\",\n            \"profile\": \"http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-communicationrequest\",\n            \"intent\": \"proposal\",\n            \"url\": \"http://example.org/ActivityDefinition/SendMessageActivity\",\n            \"name\": \"SendMessageActivity\",\n            \"title\": \"ActivityDefinition SendMessageActivity\",\n            \"status\": \"draft\",\n            \"experimental\": true,\n            \"publisher\": \"Example\",\n            \"jurisdiction\": [\n            {\n                \"coding\": [\n                {\n                    \"code\": \"001\",\n                    \"system\": \"http://unstats.un.org/unsd/methods/m49/m49.htm\",\n                    \"display\": \"World\"\n                }\n                ]\n            }\n            ],\n            \"version\": \"0.1.0\",\n            \"description\": \"Example Activity Definition for a recommendation to send a message\",\n            \"code\": {\n            \"coding\": [\n                {\n                \"code\": \"send-message\",\n                \"system\": \"http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-activity-type-cs\",\n                \"display\": \"Send a message\"\n                }\n            ]\n            },\n            \"doNotPerform\": false,\n            \"dynamicValue\": [\n            {\n                \"path\": \"payload[0].contentString\",\n                \"expression\": {\n                \"language\": \"text/fhirpath\",\n                \"expression\": \"'Greeting: Hello! ' + %subject.name.given.first() + ' Message: ' + %context.description + ' Practitioner: ' + %practitioner.name.given.first()\"\n                }\n            }\n            ]\n        }\n        },\n        {\n            \"name\": \"contentEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{contentEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"content\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{contentEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"terminologyEndpoint\",\n            \"resource\": {\n                \"resourceType\": \"Endpoint\",\n                \"address\": \"{{terminologyEndpointAddress}}\",\n                \"status\": \"active\",\n                \"payloadType\": [\n                    {\n                        \"coding\": [\n                            {\n                                \"code\": \"terminology\"\n                            }\n                        ]\n                    }\n                ],\n                \"connectionType\": {\n                    \"code\": \"{{terminologyEndpointType}}\"\n                }\n            }\n        },\n        {\n            \"name\": \"data\",\n            \"resource\": {\n                \"resourceType\": \"Bundle\",\n                \"id\": \"PatientTestBundle1\",\n                \"type\": \"collection\",\n                \"entry\": [\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Patient\",\n                            \"id\": \"Patient1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Alice\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Encounter\",\n                            \"id\": \"Encounter1\",\n                            \"status\": \"in-progress\",\n                            \"class\": {\n                                \"code\": \"AMB\",\n                                \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"participant\": [\n                                {\n                                    \"individual\": {\n                                        \"reference\": \"Practitioner/Practitioner1\"\n                                    }\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Practitioner\",\n                            \"id\": \"Practitioner1\",\n                            \"name\": [\n                                {\n                                    \"given\": [\n                                        \"Michael\"\n                                    ]\n                                }\n                            ]\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"MedicationRequest\",\n                            \"id\": \"PastMedicationRequest\",\n                            \"status\": \"active\",\n                            \"intent\": \"order\",\n                            \"authoredOn\": \"2023-01-01\",\n                            \"medicationCodeableConcept\": {\n                                \"text\": \"Some medication\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            }\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"DetectedIssue\",\n                            \"id\": \"DetectedIssue1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"TIME\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\",\n                                        \"display\": \"Time-related Detected Issue\"\n                                    }\n                                ]\n                            },\n                            \"severity\": \"high\",\n                            \"patient\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"identifiedDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Condition\",\n                            \"id\": \"Condition1\",\n                            \"clinicalStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"active\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-clinical\"\n                                    }\n                                ]\n                            },\n                            \"verificationStatus\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"provisional\",\n                                        \"system\": \"http://terminology.hl7.org/CodeSystem/condition-ver-status\"\n                                    }\n                                ]\n                            },\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"problem-list-item\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/condition-category\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"coding\": [\n                                    {\n                                        \"code\": \"422504002\",\n                                        \"system\": \"http://snomed.info/sct\",\n                                        \"display\": \"Ischemic stroke (disorder)\"\n                                    }\n                                ]\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"recordedDate\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Observation\",\n                            \"id\": \"Inference1\",\n                            \"status\": \"final\",\n                            \"code\": {\n                                \"text\": \"Inference\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"effectiveDateTime\": \"2023-01-01\"\n                        }\n                    },\n                    {\n                        \"resource\": {\n                            \"resourceType\": \"Flag\",\n                            \"id\": \"Flag1\",\n                            \"status\": \"active\",\n                            \"category\": [\n                                {\n                                    \"coding\": [\n                                        {\n                                            \"code\": \"admin\",\n                                            \"system\": \"http://terminology.hl7.org/CodeSystem/flag-category\",\n                                            \"display\": \"Administrative\"\n                                        }\n                                    ]\n                                }\n                            ],\n                            \"code\": {\n                                \"text\": \"Flag\"\n                            },\n                            \"subject\": {\n                                \"reference\": \"Patient/Patient1\"\n                            },\n                            \"period\": {\n                                \"start\": \"2023-01-01\",\n                                \"end\": \"2024-01-01\"\n                            }\n                        }\n                    }\n                ]\n            }\n        }\n    ]\n}"
				},
				"url": {
					"raw": "{{cpgServer}}/ActivityDefinition/$apply",
					"host": [
						"{{cpgServer}}"
					],
					"path": [
						"ActivityDefinition",
						"$apply"
					]
				}
			},
			"response": []
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					"/**",
					" * Delete the id and text as this can vary per request",
					" */",
					"Object.prototype.testPrepare = function testPrepare(resource) {",
					"    delete resource.id;",
					"    delete resource.text;",
					"    delete resource.meta;",
					"",
					"    return resource;",
					"}",
					"",
					"function clearEmpties(el) {",
					"  function internalClean(el) {",
					"    return _.transform(el, function(result, value, key) {",
					"      var isCollection = _.isObject(value);",
					"      var cleaned = isCollection ? internalClean(value) : value;",
					"      if (isCollection && _.isEmpty(cleaned)) {",
					"        return;",
					"      }",
					"      _.isArray(result) ? result.push(cleaned) : (result[key] = cleaned);",
					"    });",
					"  }",
					"  return _.isObject(el) ? internalClean(el) : el;",
					"}",
					"",
					"/**",
					" * Find difference between two objects",
					" * @param  {object} origObj - Source object to compare newObj against",
					" * @param  {object} newObj  - New object with potential changes",
					" * @return {object} differences",
					" */",
					"function difference(origObj, newObj) {",
					"  function changes(newObj, origObj) {",
					"    let arrayIndexCounter = 0",
					"    return _.transform(newObj, function (result, value, key) {",
					"      if (!_.isEqual(value, origObj[key])) {",
					"        let resultKey = _.isArray(origObj) ? arrayIndexCounter++ : key",
					"        result[resultKey] = (_.isObject(value) && _.isObject(origObj[key])) ? changes(value, origObj[key]) : value",
					"      }",
					"    })",
					"  }",
					"  return changes(newObj, origObj)",
					"}",
					"",
					"/**",
					" * Does a deep equal comparison, uses console.log to show diffs if fails.",
					" * ",
					" * @example",
					" * pm.test(\"My test\", function() {",
					" *   _.expectToDeepEqual(pm.response.json(), expected, console);",
					" * });",
					" */",
					"Object.prototype.expectToDeepEqual = (actual, expected, console = console) => {",
					"    try {",
					"        pm.expect(_.testPrepare(actual)).to.deep.equal(_.testPrepare(expected));",
					"    } catch (e) {",
					"        const diff1 = clearEmpties(difference(e.actual, e.expected, _.isNil));",
					"        const diff2 = clearEmpties(difference(e.expected, e.actual, _.isNil));",
					"        console.log('missing from actual:', diff1);",
					"        console.log('extraneous (found in actual but not expected):', diff2);",
					"        console.log({ actual: e.actual, expected: e.expected});",
					"        e.message = `*** See Console *** ${e.message}`;",
					"        throw new Error(e);",
					"    }",
					"}"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "cpgServer",
			"value": "http://localhost:9001",
			"type": "string"
		},
		{
			"key": "contentEndpointAddress",
			"value": "file:///Users/taylorkingston/projects/pd-apply/connectathon/output",
			"type": "string"
		},
		{
			"key": "contentEndpointType",
			"value": "hl7-fhir-file",
			"type": "string"
		},
		{
			"key": "terminologyEndpointAddress",
			"value": "file:///Users/taylorkingston/projects/pd-apply/connectathon/output",
			"type": "string"
		},
		{
			"key": "terminologyEndpointType",
			"value": "hl7-fhir-file",
			"type": "string"
		}
	]
}